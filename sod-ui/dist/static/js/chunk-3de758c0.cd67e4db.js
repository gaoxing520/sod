(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3de758c0","chunk-3de758c0"],{3034:function(e,t,a){},3979:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"handleSyncDialog"},[a("el-form",{ref:"ruleForm",attrs:{rules:e.rules,model:e.msgFormDialog,"label-width":"150px","label-position":"right"}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("任务名称")])]),e._v(" "),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"任务名称",prop:"taskName"}},[a("el-input",{attrs:{size:"medium",placeholder:"任务名称"},model:{value:e.msgFormDialog.taskName,callback:function(t){e.$set(e.msgFormDialog,"taskName",t)},expression:"msgFormDialog.taskName"}})],1)],1)],1)],1),e._v(" "),a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("源库表信息")])]),e._v(" "),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"数据来源",prop:"dataSourceId"}},[a("el-select",{attrs:{size:"medium",filterable:""},model:{value:e.msgFormDialog.dataSourceId,callback:function(t){e.$set(e.msgFormDialog,"dataSourceId",t)},expression:"msgFormDialog.dataSourceId"}},e._l(e.dataSourceIdArray,(function(e,t){return a("el-option",{key:t,attrs:{label:e.dictValue,value:e.dictValue}})})),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"源库",prop:"sourceDatabaseId"}},[a("el-select",{attrs:{size:"medium",filterable:""},on:{change:e.sourceDBChange},model:{value:e.msgFormDialog.sourceDatabaseId,callback:function(t){e.$set(e.msgFormDialog,"sourceDatabaseId",t)},expression:"msgFormDialog.sourceDatabaseId"}},e._l(e.databaseDetailArray,(function(e,t){return a("el-option",{key:t,attrs:{label:e.DATABASE_NAME,value:e.ID}})})),1)],1)],1)],1),e._v(" "),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"源表",prop:"sourceTableId"}},[a("el-select",{attrs:{size:"medium",filterable:""},on:{change:e.sourceTableChange},model:{value:e.msgFormDialog.sourceTableId,callback:function(t){e.$set(e.msgFormDialog,"sourceTableId",t)},expression:"msgFormDialog.sourceTableId"}},e._l(e.sourceTableArray,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name_cn,value:e.id,disabled:e.disabled}})})),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"源表名",prop:"sourceTableEnName"}},[a("el-input",{attrs:{disabled:!0,size:"medium",placeholder:"源表名"},model:{value:e.msgFormDialog.sourceTableEnName,callback:function(t){e.$set(e.msgFormDialog,"sourceTableEnName",t)},expression:"msgFormDialog.sourceTableEnName"}})],1)],1)],1),e._v(" "),a("el-row",{staticClass:"row-bg"},[a("el-form",{staticClass:"superSearchDialog",attrs:{model:e.stableFilterForm,"label-width":"150px"}},e._l(e.stableFilterForm.domains,(function(t){return a("el-form-item",{key:t.key,attrs:{label:"源表过滤字段"}},[a("i",{staticClass:"el-icon-plus",on:{click:e.addStableFilter}}),e._v(" "),a("i",{staticClass:"el-icon-minus",on:{click:function(a){return e.deleteStableFilter(t)}}}),e._v(" "),a("el-select",{staticStyle:{width:"35%","margin-left":"5px"},attrs:{size:"medium"},model:{value:t.sourceTableFilter,callback:function(a){e.$set(t,"sourceTableFilter",a)},expression:"domain.sourceTableFilter"}},e._l(e.columnArray,(function(e,t){return a("el-option",{key:t,attrs:{label:e.celementCode+"["+e.eleName+"]",value:e.celementCode}})})),1),e._v(" "),a("el-select",{staticStyle:{width:"22%",margin:"0px 5px"},attrs:{size:"medium",filterable:""},model:{value:t.columnOper,callback:function(a){e.$set(t,"columnOper",a)},expression:"domain.columnOper"}},e._l(e.columnOperArray,(function(e,t){return a("el-option",{key:t,attrs:{label:e.lable,value:e.value}})})),1),e._v(" "),a("el-input",{staticStyle:{width:"35%",float:"right"},attrs:{size:"medium",type:"text"},model:{value:t.sourceTableFilterText,callback:function(a){e.$set(t,"sourceTableFilterText",a)},expression:"domain.sourceTableFilterText"}})],1)})),1)],1)],1),e._v(" "),a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("同步任务参数")])]),e._v(" "),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"同步类型",prop:"syncType"}},[a("el-select",{attrs:{size:"medium"},model:{value:e.msgFormDialog.syncType,callback:function(t){e.$set(e.msgFormDialog,"syncType",t)},expression:"msgFormDialog.syncType"}},[a("el-option",{attrs:{label:"定时任务同步",value:1}}),e._v(" "),a("el-option",{attrs:{label:"数据触发同步",value:2}}),e._v(" "),a("el-option",{attrs:{label:"数据库日志同步",value:3}})],1)],1)],1)],1),e._v(" "),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[1==this.msgFormDialog.syncType?a("el-form-item",{attrs:{label:"源表查询字段",prop:"sourceTableDatecolumn"}},[a("el-select",{attrs:{size:"medium",filterable:""},model:{value:e.msgFormDialog.sourceTableDatecolumn,callback:function(t){e.$set(e.msgFormDialog,"sourceTableDatecolumn",t)},expression:"msgFormDialog.sourceTableDatecolumn"}},e._l(e.columnArray,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1):e._e()],1)],1),e._v(" "),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:12}},[1==this.msgFormDialog.syncType?a("el-form-item",{attrs:{label:"同步开始时间",prop:"beginTime"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择同步开始时间",size:"small"},model:{value:e.msgFormDialog.beginTime,callback:function(t){e.$set(e.msgFormDialog,"beginTime",t)},expression:"msgFormDialog.beginTime"}})],1):e._e()],1),e._v(" "),a("el-col",{attrs:{span:12}},[1==this.msgFormDialog.syncType?a("el-form-item",{attrs:{label:"同步频率(毫秒)",prop:"syncPeriod"}},[a("el-input",{attrs:{size:"medium",placeholder:"请输入数字"},model:{value:e.msgFormDialog.syncPeriod,callback:function(t){e.$set(e.msgFormDialog,"syncPeriod",t)},expression:"msgFormDialog.syncPeriod"}})],1):e._e()],1)],1),e._v(" "),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:12}},[2==this.msgFormDialog.syncType?a("el-form-item",{attrs:{label:"DI过滤规则",prop:"queueName"}},[a("el-input",{attrs:{size:"medium",placeholder:"STATION_LEVEL=11,12,13;DATA_TYPE=A.0010.0001.S001"},model:{value:e.msgFormDialog.queueName,callback:function(t){e.$set(e.msgFormDialog,"queueName",t)},expression:"msgFormDialog.queueName"}})],1):e._e()],1),e._v(" "),a("el-col",{attrs:{span:12}},[2==this.msgFormDialog.syncType?a("el-form-item",{attrs:{label:"主键拼接规则",prop:"primaryCom"}},[a("el-input",{attrs:{size:"medium",placeholder:"prompt:'DATA_TIME;IIiii',multiline:true"},model:{value:e.msgFormDialog.primaryCom,callback:function(t){e.$set(e.msgFormDialog,"primaryCom",t)},expression:"msgFormDialog.primaryCom"}})],1):e._e()],1)],1),e._v(" "),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"同步任务执行节点",prop:"ipAndPort"}},[a("el-select",{attrs:{size:"medium",filterable:""},model:{value:e.msgFormDialog.ipAndPort,callback:function(t){e.$set(e.msgFormDialog,"ipAndPort",t)},expression:"msgFormDialog.ipAndPort"}},e._l(e.ipAndPortArray,(function(e,t){return a("el-option",{key:t,attrs:{label:e.dictValue,value:e.dictValue}})})),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"批处理条数(条)",prop:"batchAmount"}},[a("el-input",{attrs:{size:"medium",placeholder:"请输入数字"},model:{value:e.msgFormDialog.batchAmount,callback:function(t){e.$set(e.msgFormDialog,"batchAmount",t)},expression:"msgFormDialog.batchAmount"}})],1)],1)],1),e._v(" "),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"DI/EI发送",prop:"diOff"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ccc"},model:{value:e.msgFormDialog.diOff,callback:function(t){e.$set(e.msgFormDialog,"diOff",t)},expression:"msgFormDialog.diOff"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"重复数据丢弃",prop:"discardOnDuplicate"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ccc"},model:{value:e.msgFormDialog.discardOnDuplicate,callback:function(t){e.$set(e.msgFormDialog,"discardOnDuplicate",t)},expression:"msgFormDialog.discardOnDuplicate"}})],1)],1)],1)],1),e._v(" "),a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("目标信息")])]),e._v(" "),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"数据流向",prop:"dataFlowDirectionId"}},[a("el-select",{attrs:{size:"medium",filterable:""},model:{value:e.msgFormDialog.dataFlowDirectionId,callback:function(t){e.$set(e.msgFormDialog,"dataFlowDirectionId",t)},expression:"msgFormDialog.dataFlowDirectionId"}},e._l(e.flowDirArray,(function(e,t){return a("el-option",{key:t,attrs:{label:e.dictValue,value:e.dictValue}})})),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"目标存储类型",prop:"targetType"}},[a("el-select",{attrs:{size:"medium"},model:{value:e.msgFormDialog.targetType,callback:function(t){e.$set(e.msgFormDialog,"targetType",t)},expression:"msgFormDialog.targetType"}},[a("el-option",{attrs:{label:"数据库存储",value:0}}),e._v(" "),a("el-option",{attrs:{label:"文件存储",value:1}})],1)],1)],1)],1),e._v(" "),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:24}},[0==this.msgFormDialog.targetType?a("el-form-item",{attrs:{label:"目标库",prop:"targetDatabaseId"}},[a("el-select",{attrs:{size:"medium",filterable:""},on:{change:e.targetDBChange},model:{value:e.msgFormDialog.targetDatabaseId,callback:function(t){e.$set(e.msgFormDialog,"targetDatabaseId",t)},expression:"msgFormDialog.targetDatabaseId"}},e._l(e.databaseDetailArray,(function(e,t){return a("el-option",{key:t,attrs:{label:e.DATABASE_NAME,value:e.ID}})})),1)],1):e._e()],1)],1),e._v(" "),0==this.msgFormDialog.targetType?a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"目标表",prop:"targetTable"}},[a("i",{staticClass:"el-icon-plus",on:{click:e.addnewtargetMehods}}),e._v(" "),a("i",{staticClass:"el-icon-minus"}),e._v(" "),a("el-select",{staticStyle:{width:"85%",float:"right"},attrs:{size:"medium",filterable:""},on:{change:e.targetTableChange},model:{value:e.msgFormDialog.targetTable,callback:function(t){e.$set(e.msgFormDialog,"targetTable",t)},expression:"msgFormDialog.targetTable"}},e._l(e.targetTableArray,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name_cn,value:e.id,disabled:e.disabled}})})),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"目标表名",prop:"target_table_name"}},[a("el-input",{attrs:{disabled:!0,size:"medium",placeholder:"目标表名"},model:{value:e.msgFormDialog.target_table_name,callback:function(t){e.$set(e.msgFormDialog,"target_table_name",t)},expression:"msgFormDialog.target_table_name"}})],1)],1)],1):e._e(),e._v(" "),1==this.addnewtargettable?a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"目标表",prop:"targetTable"}},[a("i",{staticClass:"el-icon-plus"}),e._v(" "),a("i",{staticClass:"el-icon-minus",on:{click:function(t){e.addnewtargettable=0}}}),e._v(" "),a("el-select",{staticStyle:{width:"85%",float:"right"},attrs:{size:"medium",filterable:""},on:{change:e.targetTableChange2},model:{value:e.msgFormDialog.targetTable2,callback:function(t){e.$set(e.msgFormDialog,"targetTable2",t)},expression:"msgFormDialog.targetTable2"}},e._l(e.targetTableArray,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name_cn,value:e.id,disabled:e.disabled}})})),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"目标表名",prop:"target_table_name"}},[a("el-input",{attrs:{disabled:!0,size:"medium",placeholder:"目标表名"},model:{value:e.msgFormDialog.target_table_name2,callback:function(t){e.$set(e.msgFormDialog,"target_table_name2",t)},expression:"msgFormDialog.target_table_name2"}})],1)],1)],1):e._e()],1),e._v(" "),a("el-tabs",{attrs:{closable:"",type:"card"},on:{"tab-remove":e.removeTab},model:{value:e.editableTabsValue,callback:function(t){e.editableTabsValue=t},expression:"editableTabsValue"}},e._l(e.editableTabs,(function(t){return a("el-tab-pane",{key:t.name,attrs:{label:t.title,name:t.name}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list,border:""}},[a("el-table-column",{attrs:{type:"index",label:"序号","min-width":"20"}}),e._v(" "),a("el-table-column",{attrs:{prop:"targetColumn_",label:"目标表字段","min-width":"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"sourceColumn_",label:"源表字段","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{model:{value:t.row.sourceColumn_,callback:function(a){e.$set(t.row,"sourceColumn_",a)},expression:"scope1.row.sourceColumn_"}})]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"操作","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-checkbox",{model:{value:t.row.isdelete,callback:function(a){e.$set(t.row,"isdelete",a)},expression:"scope.row.isdelete"}},[e._v("删除")])]}}],null,!0)})],1)],1)})),1)],1),e._v(" "),"数据注册审核"!=e.handleObj.pageName?a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},["detail"!=this.handleObj.handleType?a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.trueDialog("ruleForm")}}},[e._v("确 定")]):e._e(),e._v(" "),a("el-button",{on:{click:function(t){return e.cancelDialog("ruleForm")}}},[e._v("取 消")])],1):e._e()],1)},l=[],s=(a("28a5"),a("7f7f"),a("7514"),a("ac6a"),a("96cf"),a("3b8d")),i=a("9589"),o={name:"handleSyncDialog",props:{handleObj:{type:Object}},data:function(){return{stableFilterForm:{domains:[{sourceTableFilter:"",columnOper:""}]},isDetailStatus:!1,dataSourceIdArray:[],databaseDetailArray:[],sourceTableArray:[],targetTableArray:[],sourceVColumnDetail:[],sourceColumnDetail:[],columnArray:[],columnOperArray:[{value:"EQ",lable:"="},{value:"NE",lable:"!="},{value:"GT",lable:">"},{value:"LT",lable:"<"},{value:"GE",lable:">="},{value:"LE",lable:"<="},{value:"IN",lable:"in"},{value:"NOT in",lable:"not in"}],ipAndPortArray:[],flowDirArray:[],editableTabs:[],editableTabsValue:"",contantTaskChose:[],addnewtargettable:0,msgFormDialog:{taskName:"",dataSourceId:"",sourceDatabaseId:"",sourceTableEnName:"",KandE:"E",sourceTableFilter:"",columnOper:"",sourceTableFilterText:"",syncType:"",sourceTableDatecolumn:"",beginTime:"",syncPeriod:"",queueName:"",primaryCom:"",ipAndPort:"",batchAmount:"",diOff:!0,discardOnDuplicate:"false",targetDatabaseId:"",targetTable:"",target_table_name:"",targetTableId:"",targetTable2:"",target_table_name2:"",targetTableId2:"",sourceTableId:"",targetTableName_K:"",targetTableIds:"",tableNames:"",data_class_ids:"",tableNameCNs:"",targetColumnDetail:[],targetRelation:[],slaveRelation:{},sourceVTableId:"",targetVTableId:"",targetType:0},rules:{taskName:[{required:!0,message:"请输入任务名称",trigger:"blur"}],dataSourceId:[{required:!0,message:"请选择数据来源",trigger:"change"}],sourceDatabaseId:[{required:!0,message:"请选择源库",trigger:"change"}],sourceTableId:[{required:!0,message:"请选择源表",trigger:"change"}],sourceTableEnName:[{required:!0,message:"源表名",trigger:"blur"}],syncType:[{required:!0,message:"同步类型",trigger:"change"}],sourceTableDatecolumn:[{required:!0,message:"源表查询字段",trigger:"change"}],beginTime:[{required:!0,message:"同步开始时间",trigger:"blur"}],syncPeriod:[{required:!0,message:"同步频率",trigger:"blur"}],queueName:[{required:!0,message:"DI过滤规则",trigger:"blur"}],primaryCom:[{required:!0,message:"主键拼接规则",trigger:"blur"}],ipAndPort:[{required:!0,message:"任务执行节点",trigger:"change"}],batchAmount:[{required:!0,message:"批处理条数",trigger:"blur"}],diOff:[{required:!0,message:"DIEI发送",trigger:"blur"}],discardOnDuplicate:[{required:!0,message:"重复数据丢弃",trigger:"blur"}],dataFlowDirectionId:[{required:!0,message:"数据流向",trigger:"blur"}],targetType:[{required:!0,message:"目标存储类型",trigger:"change"}],targetDatabaseId:[{required:!0,message:"目标库",trigger:"change"}],targetTable:[{required:!0,message:"目标表",trigger:"change"}]}}},created:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["c"])("data_source_identify").then((function(e){t.dataSourceIdArray=e.data}));case 2:return e.next=4,Object(i["g"])().then((function(e){t.databaseDetailArray=e.data}));case 4:return e.next=6,Object(i["c"])("sync_run_host").then((function(e){t.ipAndPortArray=e.data}));case 6:return e.next=8,Object(i["c"])("data_flow_identify").then((function(e){t.flowDirArray=e.data}));case 8:if(!this.handleObj.id){e.next=11;break}return e.next=11,this.initDetail();case 11:if("存储结构概览"!=this.handleObj.pageName&&"资料存储策略"!=this.handleObj.pageName){e.next=22;break}return this.msgFormDialog.targetDatabaseId=this.handleObj.databaseId,this.msgFormDialog.targetTable=this.handleObj.dataClassId,e.next=16,this.targetDBChange(this.msgFormDialog.targetDatabaseId);case 16:return e.next=18,this.targetTableChange(this.msgFormDialog.targetTable,"");case 18:if(2!=this.msgFormDialog.targetTables.length){e.next=22;break}return this.msgFormDialog.targetTable2=this.msgFormDialog.targetTables[1].targetTableId,e.next=22,this.targetTableChange2(this.msgFormDialog.targetTable2,"2");case 22:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{initDetail:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.msgFormDialog=this.handleObj,e.next=3,this.sourceDBChange(this.handleObj.sourceDatabaseId);case 3:return e.next=5,this.sourceTableChange(this.handleObj.sourceTableId);case 5:return this.handleObj.sourceDBId&&(this.msgFormDialog.sourceDatabaseId=this.handleObj.sourceDBId),this.stableFilterForm={domains:[]},this.msgFormDialog.sourceTableFilter.forEach((function(e,a){var r={};r.sourceTableFilter=e,r.sourceTableFilterText=t.msgFormDialog.sourceTableFilterText[a],r.columnOper=t.msgFormDialog.columnOper[a],t.stableFilterForm.domains.push(r)})),this.msgFormDialog.targetType=0,e.next=11,this.targetDBChange(this.msgFormDialog.targetDatabaseId);case 11:return e.next=13,this.targetTableChange(this.msgFormDialog.targetTable,"");case 13:if(2!=this.msgFormDialog.targetTables.length){e.next=17;break}return this.msgFormDialog.targetTable2=this.msgFormDialog.targetTables[1].targetTableId,e.next=17,this.targetTableChange2(this.msgFormDialog.targetTable2,"2");case 17:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),sourceDBChange:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["j"])({databaseId:t}).then((function(e){for(var t=e.data,r=0;r<t.length;r++)-1!=t[r].storage_type.indexOf("K")&&"E"==t[r].db_table_type&&(t[r].disabled=!0);a.sourceTableArray=t}));case 2:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),sourceTableChange:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.findColumnByValue(t),e.next=3,this.querySourceColumn(t);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),findColumnByValue:function(e){var t={};t=this.sourceTableArray.find((function(t){return t.id===e})),console.log(t),this.msgFormDialog.sourceTableEnName=t.table_name},querySourceColumn:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a,r,l,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=19;break}if(a={},a=this.sourceTableArray.find((function(e){return e.id===t})),console.log(a),r={tableId:t},"K"!=a.db_table_type){e.next=16;break}return this.$message({showClose:!0,message:"您选择了键值表类型的键表，系统自动匹配值表"}),this.msgFormDialog.KandE="K",l="",this.sourceTableArray.forEach((function(e){e.data_class_id==a.data_class_id&&e.storage_type==a.storage_type&&e.id!=a.id&&(l=e.id,s.msgFormDialog.sourceVTableId=e.id)})),e.next=12,Object(i["f"])({tableId:l}).then((function(e){s.sourceVColumnDetail=e.data}));case 12:return e.next=14,Object(i["f"])(r).then((function(e){s.sourceColumnDetail=e.data,s.columnArray=e.data}));case 14:e.next=19;break;case 16:return this.msgFormDialog.KandE="E",e.next=19,Object(i["f"])(r).then((function(e){s.sourceColumnDetail=e.data,s.columnArray=e.data}));case 19:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),deleteStableFilter:function(e){var t=this.stableFilterForm.domains.indexOf(e);0!==t&&this.stableFilterForm.domains.splice(t,1)},addStableFilter:function(){this.stableFilterForm.domains.push({value:"",key:Date.now()})},addnewtargetMehods:function(){var e=this,t=!1;this.sourceTableArray.forEach((function(a){e.msgFormDialog.sourceTableId==a.id&&"K"==a.db_table_type&&(t=!0)})),t?this.$message({type:"error",message:"您选择了键值表类型的源表，目标表只能选一个"}):this.addnewtargettable=1},targetDBChange:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["j"])({databaseId:t}).then((function(e){for(var t=e.data,r=0;r<t.length;r++)-1!=t[r].storage_type.indexOf("K")&&"E"==t[r].db_table_type&&(t[r].disabled=!0);a.targetTableArray=t}));case 2:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),targetTableChange:function(e){this.queryTargetColumn(e,"")},targetTableChange2:function(e){this.queryTargetColumn(e,"2")},queryTargetColumn:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,a){var r,l,s,o=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(0!=this.sourceColumnDetail.length){e.next=5;break}return this.$message({showClose:!0,message:"请先选择一个源表"}),e.abrupt("return");case 5:if(r={},r=this.targetTableArray.find((function(e){return e.id===t})),l={},l=this.sourceTableArray.find((function(e){return e.id===o.msgFormDialog.sourceTableId})),l.db_table_type==r.db_table_type){e.next=12;break}return this.$message({showClose:!0,message:"源表和目标表的类型不一致"}),e.abrupt("return");case 12:if(this.msgFormDialog["target_table_name"+a]=r.table_name,"K"!=r.db_table_type){e.next=20;break}return this.$message({showClose:!0,message:"您选择了键值表类型的键表，系统自动匹配值表"}),s="",this.targetTableArray.forEach((function(e){e.data_class_id==r.data_class_id&&e.storage_type==r.storage_type&&e.id!=r.id&&(s=e,o.msgFormDialog.targetVTableId=e.id)})),e.next=19,Object(i["f"])({tableId:s.id}).then((function(e){o.targetVColumnDetail=e.data}));case 19:this.ETableMapping(s);case 20:return e.next=22,Object(i["f"])({tableId:t}).then((function(e){o.targetColumnDetail=e.data}));case 22:this.KTableMapping(r.id,r.table_name,r.data_class_id,t);case 23:case"end":return e.stop()}}),e,this)})));function t(t,a){return e.apply(this,arguments)}return t}(),KTableMapping:function(e,t,a,r){if(this.targetColumnDetail.length>0){for(var l=this.sourceColumnDetail.length,s=this.targetColumnDetail.length,i=[],o=0;o<s;o++){for(var n="",c=0;c<l;c++)if(this.targetColumnDetail[o].celementCode==this.sourceColumnDetail[c].celementCode){n=this.sourceColumnDetail[c].celementCode;break}var u={};u.targetColumn_=this.targetColumnDetail[o].celementCode,u.sourceColumn_=n,u.index=o,u.isdelete=!1,i.push(u)}var m=this.targetTableArray.find((function(e){return e.id==r}));this.editableTabs.push({title:t,name:t,list:i,tableId:e,KandE:"",content:"",stid:r,namecn:m.name_cn,data_class_ids:a}),this.editableTabsValue=t}},ETableMapping:function(e){for(var t=this.sourceVColumnDetail,a=t.length,r=this.targetVColumnDetail.length,l=[],s=0;s<r;s++){for(var i="",o=0;o<a;o++)if(this.targetVColumnDetail[s].celementCode==t[o].celementCode){i=t[o].celementCode;break}var n={};n.targetColumn_=this.targetVColumnDetail[s].celementCode,n.sourceColumn_=i,n.index=s,n.isdelete=!1,l.push(n)}this.editableTabs.push({title:e.table_name,name:e.table_name,list:l,tableId:e.id,KandE:"K",content:"",stid:e.id,namecn:e.name_cn,targetTableName_K:e.table_name,sourceTableId:e.id,sourceTableName:e.table_name}),this.editableTabsValue=e.table_name},removeTab:function(e){var t=this.editableTabs,a=this.editableTabsValue;a===e&&t.forEach((function(r,l){if(r.name===e){var s=t[l+1]||t[l-1];s&&(a=s.name)}})),this.editableTabsValue=a;var r=t.find((function(t){return t.name==e}));r.stid==this.msgFormDialog.targetTable2?(this.msgFormDialog.targetTable2="",this.msgFormDialog.target_table_name2=""):r.stid==this.msgFormDialog.targetTable&&(this.msgFormDialog.targetTable="",this.msgFormDialog.target_table_name=""),this.editableTabs=t.filter((function(t){return t.name!==e}))},trueDialog:function(e){var t=this;if(1==this.isDetailStatus)this.$refs[e].resetFields(),this.$emit("resetQuery");else{for(var a="",r="",l="",s="",o=[],n={},c=0;c<this.editableTabs.length;c++){var u=this.editableTabs[c],m=u.list,g=u.tableId;if("K"==u.KandE){this.msgFormDialog["targetColumn_K_"+g]=[],this.msgFormDialog["sourceColumn_K_"+g]=[];for(var d="",b=0;b<m.length;b++)m.isdelete||(this.msgFormDialog["targetColumn_K_"+g].push(m[b]["targetColumn_K_"]),this.msgFormDialog["sourceColumn_K_"+g].push(m[b]["sourceColumn_K_"]),d=d+"<"+m[b]["targetColumn_"]+">"+m[b]["sourceColumn_"]+"</"+m[b]["targetColumn_"]+">",d+="\r\n");n.mapping=d}else{a=a+","+g,r=r+","+u.name,l=l+","+u.data_class_ids,s=s+","+u.namecn;var h="",p="",f="";for(b=0;b<m.length;b++)m.isdelete||(h=h+","+m[b]["targetColumn_"],p=p+","+m[b]["sourceColumn_"],f=f+"<"+m[b]["targetColumn_"]+">"+m[b]["sourceColumn_"]+"</"+m[b]["targetColumn_"]+">",f+="\r\n");o.push({targetTableId:g,mapping:f}),h.length>0&&(this.msgFormDialog["targetColumn_"+g]=h.substr(1),this.msgFormDialog["sourceColumn_"+g]=p.substr(1))}}a.length>0&&(this.msgFormDialog.targetTableIds=a.substr(1),this.msgFormDialog.tableNames=r.substr(1),this.msgFormDialog.data_class_ids=l.substr(1),this.msgFormDialog.tableNameCNs=s.substr(1),this.msgFormDialog.targetRelation=o,this.msgFormDialog.slaveRelation=n);var D=this.msgFormDialog.ipAndPort.split(":");this.msgFormDialog.execIp=D[0],this.msgFormDialog.execPort=D[1];var y=this.stableFilterForm.domains;this.msgFormDialog.sourceTableFilterText=[],this.msgFormDialog.columnOper=[],this.msgFormDialog.sourceTableFilter=[],y.forEach((function(e){e&&(t.msgFormDialog.sourceTableFilterText.push(e.sourceTableFilterText),t.msgFormDialog.columnOper.push(e.columnOper),t.msgFormDialog.sourceTableFilter.push(e.sourceTableFilter))})),this.$refs[e].validate((function(e){if(!e)return!1;var a="";a=t.handleObj.id?"编辑成功":"新增成功",console.log(t.msgFormDialog),Object(i["i"])(t.msgFormDialog).then((function(e){"200"==e.code?(t.$message({type:"success",message:a}),t.$emit("resetQuery")):t.$message({type:"error",message:e.msg})}))}))}},cancelDialog:function(e){this.$refs[e].resetFields(),this.$emit("resetQuery")}}},n=o,c=(a("7f6b"),a("2877")),u=Object(c["a"])(n,r,l,!1,null,null,null);t["default"]=u.exports},7514:function(e,t,a){"use strict";var r=a("5ca1"),l=a("0a49")(5),s="find",i=!0;s in[]&&Array(1)[s]((function(){i=!1})),r(r.P+r.F*i,"Array",{find:function(e){return l(this,e,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")(s)},"7f6b":function(e,t,a){"use strict";var r=a("3034"),l=a.n(r);l.a},9589:function(e,t,a){"use strict";a.d(t,"h",(function(){return s})),a.d(t,"e",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"g",(function(){return n})),a.d(t,"j",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"i",(function(){return m})),a.d(t,"a",(function(){return g})),a.d(t,"d",(function(){return d})),a.d(t,"b",(function(){return b}));var r=a("b775"),l="http://10.40.79.18:8005";function s(e){return Object(r["a"])({url:l+"/schedule/sync/list",method:"get",params:e})}function i(e){return Object(r["a"])({url:l+"/schedule/sync/listLog",method:"get",params:e})}function o(e){return Object(r["a"])({url:l+"/schedule/sync/getDictDataByType/"+e,method:"get"})}function n(e){return Object(r["a"])({url:l+"/schedule/sync/syncDatabaseDetail",method:"get",params:e})}function c(e){return Object(r["a"])({url:l+"/schedule/sync/syncTableByDatabaseId",method:"get",params:e})}function u(e){return Object(r["a"])({url:l+"/schedule/sync/syncColumnByTableId",method:"get",params:e})}function m(e){return Object(r["a"])({url:l+"/schedule/sync/syncSaveUpdate",method:"post",data:e})}function g(e){return Object(r["a"])({url:l+"/schedule/sync/deleteSync/"+e,method:"delete"})}function d(e){return Object(r["a"])({url:l+"/schedule/sync/getSyncById/"+e,method:"get"})}function b(e){return Object(r["a"])({url:l+"/schedule/sync/export",method:"get",params:e,responseType:"arraybuffer"})}}}]);