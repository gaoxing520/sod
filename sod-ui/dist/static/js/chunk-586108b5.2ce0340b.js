(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-586108b5"],{"0e4d":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tabs",{staticClass:"handleMaterialDialog",on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"first"}},[a("el-form",{staticClass:"demo-form-inline",attrs:{model:e.formBaseInfo,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"用户名"}},[a("el-input",{attrs:{readonly:""},model:{value:e.formBaseInfo.USERREALNAME,callback:function(t){e.$set(e.formBaseInfo,"USERREALNAME",t)},expression:"formBaseInfo.USERREALNAME"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"机构"}},[a("el-input",{attrs:{readonly:""},model:{value:e.formBaseInfo.DEPARTMENT,callback:function(t){e.$set(e.formBaseInfo,"DEPARTMENT",t)},expression:"formBaseInfo.DEPARTMENT"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系方式"}},[a("el-input",{attrs:{readonly:""},model:{value:e.formBaseInfo.USERPHONE,callback:function(t){e.$set(e.formBaseInfo,"USERPHONE",t)},expression:"formBaseInfo.USERPHONE"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"申请时间"}},[a("el-input",{attrs:{readonly:""},model:{value:e.formBaseInfo.CREATE_TIME,callback:function(t){e.$set(e.formBaseInfo,"CREATE_TIME",t)},expression:"formBaseInfo.CREATE_TIME"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"数据库账户名"}},[a("el-input",{attrs:{readonly:""},model:{value:e.formBaseInfo.DATABASE_UP_ID,callback:function(t){e.$set(e.formBaseInfo,"DATABASE_UP_ID",t)},expression:"formBaseInfo.DATABASE_UP_ID"}})],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:22}},[a("el-form-item",{attrs:{label:"数据库账户密码"}},[a("el-input",{attrs:{readonly:"",type:e.passwordType,name:"password"},on:{blur:function(t){e.capsTooltip=!1}},model:{value:e.formBaseInfo.DATABASE_UP_PASSWORD,callback:function(t){e.$set(e.formBaseInfo,"DATABASE_UP_PASSWORD",t)},expression:"formBaseInfo.DATABASE_UP_PASSWORD"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"unitFormItem"},[a("i",{class:"password"===e.passwordType?"eye isEye":"el-icon-view isEye",on:{click:e.showPwd}})])],1)],1)],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"数据读写权限",name:"second"}},[a("el-alert",{attrs:{title:"申请状态：已申请"+e.tableData.length+"种资料,涉及"+e.tableData.length+"张表的读写权限， 审核通过"+e.AUTHORIZE_NUM+"张表, 审核不通过"+e.AUTHORIZEF_NUM+"张表",type:"success",closable:!1}}),e._v(" "),a("el-form",{ref:"queryForm",attrs:{model:e.queryParams,inline:!0}},[a("el-form-item",{attrs:{label:"关键字查询"}},[a("el-select",{attrs:{size:"small"},on:{change:e.changeSearch},model:{value:e.queryParams.searchSelect,callback:function(t){e.$set(e.queryParams,"searchSelect",t)},expression:"queryParams.searchSelect"}},[a("el-option",{attrs:{label:"资料分类",value:"typeName"}}),e._v(" "),a("el-option",{attrs:{label:"资料名称",value:"className"}}),e._v(" "),a("el-option",{attrs:{label:"表名称",value:"tableName"}}),e._v(" "),a("el-option",{attrs:{label:"数据库",value:"databaseName"}}),e._v(" "),a("el-option",{attrs:{label:"申请状态",value:"applyAuthority"}}),e._v(" "),a("el-option",{attrs:{label:"审核状态",value:"authorize"}}),e._v(" "),a("el-option",{attrs:{label:"专题名",value:"specialDatabaseName"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-input",{attrs:{size:"small",type:"text"},model:{value:e.queryParams.searchInput,callback:function(t){e.$set(e.queryParams,"searchInput",t)},expression:"queryParams.searchInput"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.handleQuery}},[e._v("查询")])],1)],1),e._v(" "),a("el-row",{staticClass:"mb8",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-thumb",size:"mini"},on:{click:e.handlePower}},[e._v("授权")]),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-close",size:"mini"},on:{click:e.handleRefused}},[e._v("拒接")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.tableData,"row-key":"id"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"TYPE_NAME",label:"资料分类","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"CLASS_NAME",label:"资料名称","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"TABLE_NAME",label:"表名称","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"DATABASE_NAME",label:"数据库","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"SPECIAL_DATABASE_NAME",label:"专题名","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"IS_ACCESS",label:"权限",width:"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return["0"==t.row.IS_ACCESS?a("span",[e._v("受限")]):a("span",[e._v("公开")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"APPLY_AUTHORITY",label:"申请状态",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return["1"==t.row.APPLY_AUTHORITY?a("span",[e._v("读申请")]):a("span",[e._v("读写申请")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"AUTHORIZE",label:"审核状态",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return["2"==t.row.AUTHORIZE?a("span",[a("i",{staticClass:"el-icon-circle-close",staticStyle:{color:"#F56C6C"}}),e._v("拒绝\n          ")]):"1"==t.row.AUTHORIZE?a("span",[a("i",{staticClass:"el-icon-circle-check",staticStyle:{color:"#67C23A"}}),e._v("通过\n          ")]):a("span",[a("i",{staticClass:"el-icon-s-finance",staticStyle:{color:"#E6A23C"}}),e._v("待审核\n          ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"CAUSE",label:"拒绝原因",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.CAUSE?a("el-popover",{attrs:{placement:"top",effect:"dark",trigger:"hover",width:"200","popper-class":"darkPopover"}},[a("p",[e._v(e._s(t.row.CAUSE))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("el-button",{staticClass:"tagpointer",attrs:{type:"primary",size:"mini",plain:""}},[e._v("查看")])],1)]):e._e()]}}])})],1)],1)],1)},o=[],r=(a("ac6a"),a("96cf"),a("3b8d")),n=a("e254"),s={name:"handleMaterialDialog",props:{handleObj:{type:Object}},data:function(){return{passwordType:"password",activeName:"first",formBaseInfo:{},queryParams:{},searchKey:"",loading:!1,tableData:[],total:0,AUTHORIZE_NUM:0,AUTHORIZEF_NUM:0,multipleSelection:[]}},created:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.queryParams.id=this.handleObj.id,!this.handleObj.id){e.next=4;break}return e.next=4,Object(n["a"])({id:this.handleObj.id}).then((function(e){200==e.code?t.formBaseInfo=e.data:t.msgError(e.msg)}));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{showPwd:function(){"password"===this.passwordType?this.passwordType="":this.passwordType="password"},handleClick:function(){"second"==this.activeName&&this.handleQuery()},handleSelectionChange:function(e){this.multipleSelection=e},changeSearch:function(e){this.searchKey=e},getList:function(e){var t=this;console.log(e),Object(n["c"])(e).then((function(e){200==e.code?(t.tableData=e.data,t.AUTHORIZE_NUM=0,t.AUTHORIZEF_NUM0=0,t.tableData.forEach((function(e){1==e.AUTHORIZE?t.AUTHORIZE_NUM++:2==e.AUTHORIZE&&t.AUTHORIZEF_NUM++}))):t.msgError(e.msg)}))},handleQuery:function(){var e=this.queryParams.searchInput;"applyAuthority"!=this.searchKey&&"authorize"!=this.searchKey||(e="读申请"==e||"通过"==e?"1":"读写申请"==e||"拒绝"==e?"2":"");var t={};t.applyId=this.queryParams.id,t[this.queryParams.searchSelect]=e,this.getList(t)},handlePower:function(){0!=this.multipleSelection.lenght?(console.log(this.multipleSelection),this.powerMethods()):this.msgError("请选择一条数据")},handleRefused:function(){var e=this;0!=this.multipleSelection.lenght?this.$prompt("请输入拒绝原因","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"拒绝原因不能为空"}).then((function(t){var a=t.value;e.powerMethods(a)})).catch((function(){})):this.msgError("请选择一条数据")},powerMethods:function(e){var t=this,a={userId:"admin",dataAuthorityRecordList:[]};this.multipleSelection.forEach((function(t){var l={};l.id=t.ID,l.applyId=t.APPLY_ID,l.databaseId=t.DATABASE_ID,l.applyAuthority=t.APPLY_AUTHORITY,l.authorize=e?2:1,l.dataClassId=t.DATA_CLASS_ID,l.cause=e,a.dataAuthorityRecordList.push(l)})),console.log(a),Object(n["f"])(JSON.parse(JSON.stringify(a))).then((function(a){200==a.code?(e?t.msgSuccess("拒绝成功"):t.msgSuccess("授权成功"),t.handleQuery()):t.msgError(a.msg)}))}}},i=s,c=(a("9fa9"),a("2877")),u=Object(c["a"])(i,l,o,!1,null,null,null);t["default"]=u.exports},"7b00":function(e,t,a){},"9fa9":function(e,t,a){"use strict";var l=a("7b00"),o=a.n(l);o.a},e254:function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"a",(function(){return n})),a.d(t,"c",(function(){return s})),a.d(t,"f",(function(){return i})),a.d(t,"b",(function(){return c})),a.d(t,"e",(function(){return u}));var l=a("b775"),o="http://10.40.79.18:8005";function r(e){return Object(l["a"])({url:o+"/dm/dataAuthorityApply/list",method:"get",params:e})}function n(e){return Object(l["a"])({url:o+"/dm/dataAuthorityApply/getApplyInfoById",method:"get",params:e})}function s(e){return Object(l["a"])({url:o+"/dm/dataAuthorityApply/getRecordByApplyId",method:"get",params:e})}function i(e){return Object(l["a"])({url:o+"/dm/dataAuthorityApply/updateRecordCheck",method:"PUT",data:e})}function c(e){return Object(l["a"])({url:o+"/dm/dataAuthorityApply/getReadAuthority",method:"get",params:e})}function u(e){return Object(l["a"])({url:o+"/dm/dataAuthorityApply/updateReadAuthority",method:"post",data:e})}}}]);