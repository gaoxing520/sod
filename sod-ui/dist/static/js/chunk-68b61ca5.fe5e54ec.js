(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-68b61ca5"],{"71c8":function(e,a,t){},7514:function(e,a,t){"use strict";var s=t("5ca1"),r=t("0a49")(5),l="find",o=!0;l in[]&&Array(1)[l]((function(){o=!1})),s(s.P+s.F*o,"Array",{find:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),t("9c6c")(l)},"99d2":function(e,a,t){"use strict";var s=t("71c8"),r=t.n(s);r.a},d0d2:function(e,a,t){"use strict";t.d(a,"a",(function(){return l})),t.d(a,"g",(function(){return o})),t.d(a,"b",(function(){return i})),t.d(a,"i",(function(){return n})),t.d(a,"c",(function(){return m})),t.d(a,"f",(function(){return c})),t.d(a,"e",(function(){return u})),t.d(a,"d",(function(){return g})),t.d(a,"h",(function(){return d}));var s=t("b775"),r="http://10.40.79.18:8005";function l(e){return Object(s["a"])({url:r+"/dm/cloudDatabaseApply/list",method:"get",params:e})}function o(e){return Object(s["a"])({url:r+"/dm/cloudDatabaseApply/getDictDataByType/"+e,method:"get"})}function i(e){return Object(s["a"])({url:r+"/dm/cloudDatabaseApply/deleteById",method:"delete",params:e})}function n(e){return Object(s["a"])({url:r+"/dm/cloudDatabaseApply/save",method:"post",data:e})}function m(e){return Object(s["a"])({url:r+"/dm/cloudDatabaseApply/edit",method:"put",data:e})}function c(e){return Object(s["a"])({url:r+"/dm/cloudDatabaseApply/getById",method:"get",params:e})}function u(e){return Object(s["a"])({url:r+"/dm/cloudDatabaseApply/download",method:"get",params:e,responseType:"arraybuffer"})}function g(){return Object(s["a"])({url:r+"/dm/databaseDefine/export",method:"get",params:{name:"clouddatabase-application"},responseType:"arraybuffer"})}function d(e){return Object(s["a"])({url:r+"/system/user/getUserByType",method:"get",params:e})}},d1f7:function(e,a,t){"use strict";t.r(a);var s=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("section",{staticClass:"handleCloudDialog"},[t("el-form",{ref:"ruleForm",attrs:{rules:e.rules,model:e.msgFormDialog,"label-width":"150px","label-position":"right"}},[t("el-card",{staticClass:"box-card"},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("申请信息")])]),e._v(" "),t("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"申请用户",prop:"userId"}},[void 0==this.searchObj.id?t("el-select",{attrs:{size:"small",filterable:""},on:{change:e.userChange},model:{value:e.msgFormDialog.userId,callback:function(a){e.$set(e.msgFormDialog,"userId",a)},expression:"msgFormDialog.userId"}},e._l(e.userBox,(function(e,a){return t("el-option",{key:a,attrs:{label:e.webUsername,value:e.userName}})})),1):t("el-input",{attrs:{disabled:!0,size:"small"},model:{value:e.msgFormDialog.userId,callback:function(a){e.$set(e.msgFormDialog,"userId",a)},expression:"msgFormDialog.userId"}})],1)],1),e._v(" "),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"申请单位",prop:"department"}},[t("el-input",{attrs:{disabled:e.isDetail,size:"small",placeholder:"申请单位"},model:{value:e.msgFormDialog.department,callback:function(a){e.$set(e.msgFormDialog,"department",a)},expression:"msgFormDialog.department"}})],1)],1),e._v(" "),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"联系电话",prop:"telephone"}},[t("el-input",{attrs:{disabled:e.isDetail,size:"small",placeholder:"联系电话"},model:{value:e.msgFormDialog.telephone,callback:function(a){e.$set(e.msgFormDialog,"telephone",a)},expression:"msgFormDialog.telephone"}})],1)],1)],1),e._v(" "),t("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"数据库类型",prop:"storageLogic"}},[t("el-select",{attrs:{disabled:e.isDetail,size:"small"},on:{change:e.storageChange},model:{value:e.msgFormDialog.storageLogic,callback:function(a){e.$set(e.msgFormDialog,"storageLogic",a)},expression:"msgFormDialog.storageLogic"}},e._l(e.storageLogicList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.dictLabel,value:e.dictValue}})})),1)],1)],1),e._v(" "),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"数据库名",prop:"databaseName"}},[t("el-input",{attrs:{disabled:e.isDetail,size:"small",placeholder:"数据库名"},model:{value:e.msgFormDialog.databaseName,callback:function(a){e.$set(e.msgFormDialog,"databaseName",a)},expression:"msgFormDialog.databaseName"}})],1)],1),e._v(" "),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"应用系统",prop:"applicationSystem"}},[t("el-input",{attrs:{disabled:e.isDetail,size:"small",placeholder:"应用系统"},model:{value:e.msgFormDialog.applicationSystem,callback:function(a){e.$set(e.msgFormDialog,"applicationSystem",a)},expression:"msgFormDialog.applicationSystem"}})],1)],1)],1),e._v(" "),t("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"申请存储空间大小",prop:"storageSpace"}},[t("el-select",{attrs:{disabled:e.isDetail,size:"small"},model:{value:e.msgFormDialog.storageSpace,callback:function(a){e.$set(e.msgFormDialog,"storageSpace",a)},expression:"msgFormDialog.storageSpace"}},e._l(e.storageSpaceList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.dictValue,value:e.dictValue}})})),1)],1)],1),e._v(" "),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"用途",prop:"databaseUse"}},[t("el-input",{attrs:{disabled:e.isDetail,size:"small",placeholder:"用途"},model:{value:e.msgFormDialog.databaseUse,callback:function(a){e.$set(e.msgFormDialog,"databaseUse",a)},expression:"msgFormDialog.databaseUse"}})],1)],1),e._v(" "),t("el-col",{attrs:{span:8}},["redis"!=e.msgFormDialog.storageLogic&&"file"!=e.msgFormDialog.storageLogic?t("el-form-item",{attrs:{label:"申请CPU/内存",prop:"cpuMemory"}},[t("el-select",{attrs:{disabled:e.isDetail,size:"small"},model:{value:e.msgFormDialog.cpuMemory,callback:function(a){e.$set(e.msgFormDialog,"cpuMemory",a)},expression:"msgFormDialog.cpuMemory"}},e._l(e.cpuList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.dictValue,value:e.dictValue}})})),1)],1):e._e()],1)],1)],1),e._v(" "),t("el-card",{staticClass:"box-card"},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("审核信息")])]),e._v(" "),void 0==this.searchObj.id?t("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"审核人",prop:"examiner"}},[t("el-input",{attrs:{size:"small",placeholder:"审核人"},model:{value:e.msgFormDialog.examiner,callback:function(a){e.$set(e.msgFormDialog,"examiner",a)},expression:"msgFormDialog.examiner"}})],1)],1),e._v(" "),t("el-col",{attrs:{span:10}},[t("el-form-item",{attrs:{label:"单位审核材料",prop:"examineMaterial"}},[t("el-upload",{staticClass:"upload-demo",attrs:{accept:".docx",limit:1,"on-exceed":e.handleExceed,action:e.upLoadUrl,"on-success":e.successUpload,"before-upload":e.handleBefore,data:e.uploadData},model:{value:e.msgFormDialog.examineMaterial,callback:function(a){e.$set(e.msgFormDialog,"examineMaterial",a)},expression:"msgFormDialog.examineMaterial"}},[t("el-button",{attrs:{size:"small"}},[e._v("点击上传(只能上传docx文件)")])],1)],1)],1),e._v(" "),t("el-col",{attrs:{span:6}},[t("el-form-item",[t("el-button",{attrs:{size:"small",type:"success"},on:{click:e.demoDownload}},[e._v("模板下载")])],1)],1)],1):t("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"审核状态",prop:"examineStatus"}},[t("el-radio",{attrs:{disabled:e.isDetailStatus,label:"02"},on:{change:e.statusChange},model:{value:e.msgFormDialog.examineStatus,callback:function(a){e.$set(e.msgFormDialog,"examineStatus",a)},expression:"msgFormDialog.examineStatus"}},[e._v("允许")]),e._v(" "),t("el-radio",{attrs:{disabled:e.isDetailStatus,label:"03"},on:{change:e.statusChange},model:{value:e.msgFormDialog.examineStatus,callback:function(a){e.$set(e.msgFormDialog,"examineStatus",a)},expression:"msgFormDialog.examineStatus"}},[e._v("拒绝")])],1)],1),e._v(" "),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"审核人",prop:"examiner"}},[t("el-input",{attrs:{disabled:e.isDetailStatus,size:"small",placeholder:"审核人"},model:{value:e.msgFormDialog.examiner,callback:function(a){e.$set(e.msgFormDialog,"examiner",a)},expression:"msgFormDialog.examiner"}})],1)],1),e._v(" "),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"单位审核材料",prop:"examineMaterial"}},[t("el-button",{attrs:{size:"small",type:"success"},on:{click:e.handleExport}},[e._v("下载查看审核文件")])],1)],1)],1),e._v(" "),e.isReason?t("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"未通过审核原因",prop:"failure_reason"}},[t("el-input",{attrs:{disabled:e.isDetailStatus,size:"small",placeholder:"拒绝原因"},model:{value:e.msgFormDialog.failure_reason,callback:function(a){e.$set(e.msgFormDialog,"failure_reason",a)},expression:"msgFormDialog.failure_reason"}})],1)],1)],1):e._e()],1),e._v(" "),e.examineStatus||"database"!=e.msgFormDialog.storageLogic?t("el-card",{staticClass:"box-card"},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("分配信息")])]),e._v(" "),"redis"!=e.msgFormDialog.storageLogic&&"database"!=e.msgFormDialog.storageLogic?t("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"挂载服务器",prop:"mountServer"}},[t("el-input",{attrs:{disabled:e.isDetail,size:"small",placeholder:"挂载服务器"},model:{value:e.msgFormDialog.mountServer,callback:function(a){e.$set(e.msgFormDialog,"mountServer",a)},expression:"msgFormDialog.mountServer"}})],1)],1),e._v(" "),t("el-col",{attrs:{span:8}},[t("el-row",[t("el-col",{attrs:{span:20}},[t("el-form-item",{attrs:{label:"挂载目录",prop:"mountDirectory"}},[t("el-input",{attrs:{disabled:e.isDetail,size:"small",placeholder:"挂载目录"},model:{value:e.msgFormDialog.mountDirectory,callback:function(a){e.$set(e.msgFormDialog,"mountDirectory",a)},expression:"msgFormDialog.mountDirectory"}})],1)],1),e._v(" "),t("el-col",{staticClass:"spacialBtn",attrs:{span:4}},[t("el-form-item",[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.helpPassword}},[e._v("帮助")])],1)],1)],1)],1),e._v(" "),t("el-col",{attrs:{span:8}})],1):e._e(),e._v(" "),"file"!=e.msgFormDialog.storageLogic?t("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"数据库IP",prop:"databaseIp"}},[t("el-input",{attrs:{disabled:e.isDetailStatus,size:"small",placeholder:"数据库IP"},model:{value:e.msgFormDialog.databaseIp,callback:function(a){e.$set(e.msgFormDialog,"databaseIp",a)},expression:"msgFormDialog.databaseIp"}})],1)],1),e._v(" "),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"数据库端口号",prop:"databasePort"}},[t("el-input",{attrs:{disabled:e.isDetailStatus,size:"small",placeholder:"数据库端口号"},model:{value:e.msgFormDialog.databasePort,callback:function(a){e.$set(e.msgFormDialog,"databasePort",a)},expression:"msgFormDialog.databasePort"}})],1)],1),e._v(" "),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"实际分配存储空间",prop:"newStorageSpace"}},[t("el-select",{attrs:{disabled:e.isDetailStatus,size:"small"},model:{value:e.msgFormDialog.newStorageSpace,callback:function(a){e.$set(e.msgFormDialog,"newStorageSpace",a)},expression:"msgFormDialog.newStorageSpace"}},e._l(e.storageSpaceList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.dictValue,value:e.dictValue}})})),1)],1)],1)],1):e._e(),e._v(" "),"file"!=e.msgFormDialog.storageLogic?t("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"数据库用户名",prop:"databaseUsername"}},[t("el-input",{attrs:{disabled:e.isDetailStatus,size:"small",placeholder:"数据库用户名"},model:{value:e.msgFormDialog.databaseUsername,callback:function(a){e.$set(e.msgFormDialog,"databaseUsername",a)},expression:"msgFormDialog.databaseUsername"}})],1)],1),e._v(" "),t("el-col",{attrs:{span:8}},[t("el-row",{attrs:{gutter:4}},[t("el-col",{attrs:{span:18}},[t("el-form-item",{attrs:{label:"数据库密码",prop:"databasePassword"}},[t("el-input",{attrs:{disabled:e.isDetailStatus,type:e.passwordType,size:"small",placeholder:"数据库密码"},model:{value:e.msgFormDialog.databasePassword,callback:function(a){e.$set(e.msgFormDialog,"databasePassword",a)},expression:"msgFormDialog.databasePassword"}})],1)],1),e._v(" "),t("el-col",{attrs:{span:2}},[t("i",{class:"password"===e.passwordType?"eye isEye":"el-icon-view isEye",on:{click:e.showPwd}})])],1)],1),e._v(" "),t("el-col",{attrs:{span:8}},["redis"!=e.msgFormDialog.storageLogic&&"file"!=e.msgFormDialog.storageLogic?t("el-form-item",{attrs:{label:"实际分配CPU/内存",prop:"newCpuMemory"}},[t("el-select",{attrs:{disabled:e.isDetailStatus,size:"small"},model:{value:e.msgFormDialog.newCpuMemory,callback:function(a){e.$set(e.msgFormDialog,"newCpuMemory",a)},expression:"msgFormDialog.newCpuMemory"}},e._l(e.cpuList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.dictValue,value:e.dictValue}})})),1)],1):e._e()],1)],1):e._e()],1):e._e()],1),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.trueDialog("ruleForm")}}},[e._v("确 定")]),e._v(" "),t("el-button",{on:{click:function(a){return e.cancelDialog("ruleForm")}}},[e._v("取 消")])],1)],1)},r=[],l=(t("7514"),t("d0d2")),o=t("4b67"),i="http://10.40.79.18:8005",n={name:"handleCloudDialog",props:{handleObj:{type:Object}},data:function(){var e=function(e,a,t){""===a?t(new Error("请输入申请单位")):Object(o["b"])(a)?t():t(new Error("申请单位格式不正确"))},a=function(e,a,t){""===a?t(new Error("请输入联系电话")):Object(o["k"])(a)?t():t(new Error("电话号码格式不正确"))},t=function(e,a,t){""===a?t(new Error("请输入端口号")):Object(o["j"])(a)?t():t(new Error("端口号格式不正确"))},s=function(e,a,t){""===a?t(new Error("请输入IP地址")):Object(o["f"])(a)?t():t(new Error("请输入正确的IP地址"))};return{passwordType:"",isReason:!1,isDetail:!1,isDetailStatus:!1,uploadData:{},upLoadUrl:i+"/dm/cloudDatabaseApply/upload",isDisabled:!1,examineStatus:!0,userBox:[],storageSpaceList:[],storageLogicList:[],searchObj:{},contantTaskChose:[],msgFormDialog:{userId:"",department:"",telephone:"",storageLogic:"",databaseName:"",applicationSystem:"",storageSpace:"",databaseUse:"",cpuMemory:"",mountServer:"",mountDirectory:"",examiner:"",examineMaterial:"",databaseIp:"",databasePort:"",databaseUsername:"",databasePassword:""},cpuList:[],rules:{userId:[{required:!0,message:"请选择申请用户",trigger:"change"}],department:[{required:!0,validator:e,trigger:"blur"}],telephone:[{required:!0,validator:a,trigger:"blur"}],storageLogic:[{required:!0,message:"请选择数据库类型",trigger:"change"}],databaseName:[{required:!0,message:"请输入数据库名",trigger:"blur"}],applicationSystem:[{required:!0,message:"请输入应用系统",trigger:"blur"}],storageSpace:[{required:!0,message:"请选择申请存储空间大小",trigger:"blur"}],databaseUse:[{required:!0,message:"请输入数据库用途",trigger:"blur"}],cpuMemory:[{required:!0,message:"请输入申请CPU/内存",trigger:"blur"}],mountServer:[{required:!0,message:"请输入挂载服务器",trigger:"blur"}],mountDirectory:[{required:!0,message:"请输入挂载目录",trigger:"blur"}],examiner:[{required:!0,message:"请输入审核人",trigger:"blur"}],examineMaterial:[{required:!0,message:"请选择审核材料",trigger:"change"}],databaseIp:[{required:!0,validator:s,trigger:"blur"}],databasePort:[{required:!0,validator:t,trigger:"blur"}],databaseUsername:[{required:!0,message:"请输入数据库用户名",trigger:"blur"}],databasePassword:[{required:!0,message:"请输入数据库密码",trigger:"blur"}],failure_reason:[{required:!0,message:"请输入拒绝原因",trigger:"blur"}],newCpuMemory:[{required:!0,message:"请输入实际分配CPU/内存",trigger:"blur"}],examineStatus:[{required:!0,message:"请选择审核状态",trigger:"change"}],newStorageSpace:[{required:!0,message:"请输入实际分配存储空间",trigger:"blur"}]}}},created:function(){var e=this;this.getUserAll(),this.searchObj=this.handleObj,this.msgFormDialog=this.handleObj,this.getDicts("cloud_database_type").then((function(a){e.storageLogicList=a.data})),this.getDicts("cloud_cup_type").then((function(a){e.cpuList=a.data})),this.initServerDetail()},methods:{showPwd:function(){"password"===this.passwordType?this.passwordType="":this.passwordType="password"},handleExceed:function(){this.$message.warning("当前限制选择1个文件")},handleBefore:function(e){this.uploadData.filename=e},successUpload:function(e,a,t){this.msgFormDialog.examineMaterial=e.msg},userChange:function(e){var a={};a=this.userBox.find((function(a){return a.userName===e})),this.msgFormDialog.telephone=a.tutorPhone,this.msgFormDialog.department=a.deptName},getUserAll:function(){var e=this;Object(l["h"])({userType:11}).then((function(a){e.userBox=a.data}))},storageChange:function(e){var a=this;console.log(e),this.msgFormDialog.storageSpaceList=[],Object(l["g"])("cloud_"+e+"_storage_space").then((function(e){a.storageSpaceList=e.data}))},handleExport:function(){var e=this;Object(l["e"])({examineMaterial:this.msgFormDialog.examineMaterial}).then((function(a){e.downloadfileCommon(a)}))},demoDownload:function(){var e=this;Object(l["d"])({examineMaterial:this.msgFormDialog.examineMaterial}).then((function(a){e.downloadfileCommon(a)}))},initServerDetail:function(){this.searchObj.id&&(this.msgFormDialog=this.searchObj,this.msgFormDialog.userId=this.searchObj.application_user,this.isDetail=!0,"02"==this.msgFormDialog.examineStatus?(this.examineStatus=!0,this.isDetailStatus=!0):"03"==this.msgFormDialog.examineStatus?(this.isDetailStatus=!0,this.examineStatus=!1,this.isReason=!0):(this.isDetailStatus=!1,this.examineStatus=!1,console.log("没有状态")))},statusChange:function(e){"02"==e?(this.examineStatus=!0,this.isReason=!1):(this.examineStatus=!1,this.isReason=!0)},helpPassword:function(){var e=this.$createElement;this.$msgbox({title:"帮助",customClass:"helpMsgBox",message:e("p",null,[e("span",{style:"font-size: 16px"},"磁盘挂载到服务器的操作步骤： "),e("p",null,"(1)打开服务器中/etc/fstab文件 "),e("p",null,"(2)增加一行：nfs03.lan.nmic.cn:/nmic-dashuju-20181226 /本地路径(提前创建好) nfs nfsvers=3,async,nolock,noatime,nodiratime,wsize=1048576,rsize=1048576,timeo=600  0 0"),e("p",null,"(3)文件编辑完成，保存退出"),e("p",null,"(4)在命令行输入mount -a，进行磁盘挂载"),e("p",null," (5)在命令行输入df -h，查看是否挂载成功")]),confirmButtonText:"确定"}).then((function(e){})).catch((function(){}))},trueDialog:function(e){var a=this;1==this.isDetailStatus?(this.$refs[e].resetFields(),this.$emit("cancelHandle")):(console.log(this.msgFormDialog),this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;a.handleObj.id?Object(l["c"])(a.msgFormDialog).then((function(e){200==e.code?(a.$message({type:"success",message:"编辑成功"}),a.$emit("handleDialogClose")):a.$message({type:"error",message:e.msg})})):(a.msgFormDialog.examineStatus="02",Object(l["i"])(a.msgFormDialog).then((function(e){200==e.code?(a.$message({type:"success",message:"增加成功"}),a.$emit("handleDialogClose")):a.$message({type:"error",message:e.msg})})))})))},cancelDialog:function(e){this.$refs[e].resetFields(),this.$emit("handleDialogClose")}}},m=n,c=(t("99d2"),t("2877")),u=Object(c["a"])(m,s,r,!1,null,null,null);a["default"]=u.exports}}]);