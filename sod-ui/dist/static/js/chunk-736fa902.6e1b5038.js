(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-736fa902"],{2915:function(e,a,t){"use strict";var s=t("c7a8"),r=t.n(s);r.a},c7a8:function(e,a,t){},ca31:function(e,a,t){"use strict";t.d(a,"d",(function(){return l})),t.d(a,"c",(function(){return o})),t.d(a,"b",(function(){return i})),t.d(a,"g",(function(){return n})),t.d(a,"e",(function(){return m})),t.d(a,"a",(function(){return c})),t.d(a,"f",(function(){return d}));var s=t("b775"),r="http://10.40.79.18:8005";function l(e){return Object(s["a"])({url:r+"/dm/databaseDefine/page",method:"get",params:e})}function o(e){return Object(s["a"])({url:r+"/dm/databaseDefine/save",method:"post",data:e})}function i(e){return Object(s["a"])({url:r+"/dm/databaseDefine/get",async:!0,method:"get",params:e})}function n(e){return Object(s["a"])({url:r+"/dm/database/findByDatabaseDefineId",method:"get",params:e})}function m(e){return Object(s["a"])({url:r+"/dm/databaseDefine/delByIds",method:"delete",params:e})}function c(e){return Object(s["a"])({url:r+"/dm/databaseDefine/conStatus",method:"get",params:e})}function d(e){return Object(s["a"])({url:r+"/dm/databaseDefine/export",method:"get",params:e})}},f7b9:function(e,a,t){"use strict";t.r(a);var s=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("section",{staticClass:"filedSearchDeploy"},[t("el-tabs",{staticClass:"pageTas",on:{click:e.pageTasChange},model:{value:e.activeName,callback:function(a){e.activeName=a},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"基本信息",name:"first"}},[t("el-scrollbar",{attrs:{"wrap-class":"scrollbar-wrapper"}},[t("el-form",{ref:"msgFormDialog",staticClass:"baseForm",attrs:{model:e.msgFormDialog,rules:e.baseFormRules,"label-width":"140px"}},[t("el-form-item",{attrs:{prop:"schemaName",label:"模式名称:"}},[t("el-input",{attrs:{size:"small",placeholder:"请输入数据库实例"},model:{value:e.msgFormDialog.databaseDto.schemaName,callback:function(a){e.$set(e.msgFormDialog.databaseDto,"schemaName",a)},expression:"msgFormDialog.databaseDto.schemaName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"数据库分类:"}},[t("el-input",{attrs:{size:"small",disabled:"disabled"},model:{value:e.msgFormDialog.databaseDto.databaseClassify,callback:function(a){e.$set(e.msgFormDialog.databaseDto,"databaseClassify",a)},expression:"msgFormDialog.databaseDto.databaseClassify"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"数据库名称:"}},[t("el-input",{attrs:{size:"small",disabled:"disabled",placeholder:"请输入数据库实例"},model:{value:e.msgFormDialog.databaseDto.databaseName,callback:function(a){e.$set(e.msgFormDialog.databaseDto,"databaseName",a)},expression:"msgFormDialog.databaseDto.databaseName"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"id",label:"数据库ID:"}},[t("el-input",{attrs:{size:"small",disabled:e.isDbIdDisable,placeholder:"请输入数据库ID"},model:{value:e.msgFormDialog.id,callback:function(a){e.$set(e.msgFormDialog,"id",a)},expression:"msgFormDialog.id"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"databaseName",label:"数据库名称:"}},[t("el-input",{attrs:{size:"small",placeholder:"请输入数据库名称"},model:{value:e.msgFormDialog.databaseName,callback:function(a){e.$set(e.msgFormDialog,"databaseName",a)},expression:"msgFormDialog.databaseName"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"serialNumber",label:"显示序号:"}},[t("el-input-number",{staticClass:"number",attrs:{size:"small",placeholder:"请输入显示序号"},model:{value:e.msgFormDialog.serialNumber,callback:function(a){e.$set(e.msgFormDialog,"serialNumber",a)},expression:"msgFormDialog.serialNumber"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"databaseInstance",label:"数据库实例:"}},[t("el-input",{attrs:{size:"small",placeholder:"请输入数据库实例"},model:{value:e.msgFormDialog.databaseInstance,callback:function(a){e.$set(e.msgFormDialog,"databaseInstance",a)},expression:"msgFormDialog.databaseInstance"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"databaseType",label:"数据库类型:"}},[t("el-select",{model:{value:e.msgFormDialog.databaseType,callback:function(a){e.$set(e.msgFormDialog,"databaseType",a)},expression:"msgFormDialog.databaseType"}},e._l(e.dictsList,(function(e){return t("el-option",{key:e.dictValue,attrs:{label:e.dictLabel,value:e.dictValue}})})),1)],1),e._v(" "),t("el-form-item",{attrs:{prop:"driverClassName",label:"数据库驱动:"}},[t("el-input",{attrs:{size:"small",placeholder:"请输入数据库驱动"},model:{value:e.msgFormDialog.driverClassName,callback:function(a){e.$set(e.msgFormDialog,"driverClassName",a)},expression:"msgFormDialog.driverClassName"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"databaseIp",label:"数据库IP:"}},[t("el-input",{attrs:{size:"small",placeholder:"请输入数据库IP"},model:{value:e.msgFormDialog.databaseIp,callback:function(a){e.$set(e.msgFormDialog,"databaseIp",a)},expression:"msgFormDialog.databaseIp"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"databasePort",label:"数据库端口:"}},[t("el-input-number",{staticClass:"number",attrs:{size:"small",placeholder:"请输入数据库端口"},model:{value:e.msgFormDialog.databasePort,callback:function(a){e.$set(e.msgFormDialog,"databasePort",a)},expression:"msgFormDialog.databasePort"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"databaseUrl",label:"数据库访问地址:"}},[t("el-row",[t("el-col",{attrs:{span:20}},[t("el-input",{attrs:{size:"small",placeholder:"请输入数据库访问地址"},model:{value:e.msgFormDialog.databaseUrl,callback:function(a){e.$set(e.msgFormDialog,"databaseUrl",a)},expression:"msgFormDialog.databaseUrl"}})],1),e._v(" "),t("el-col",{staticClass:"unitFormItem",attrs:{span:4}},[t("el-button",{staticClass:"childBtn",attrs:{size:"small",type:"primary"},on:{click:function(a){return e.checkParam()}}},[e._v("测试连接")])],1)],1)],1),e._v(" "),t("el-form-item",{attrs:{prop:"upUrl",label:"UP层访问地址:"}},[t("el-input",{attrs:{size:"small",placeholder:"请输入UP层访问地址"},model:{value:e.msgFormDialog.upUrl,callback:function(a){e.$set(e.msgFormDialog,"upUrl",a)},expression:"msgFormDialog.upUrl"}})],1),e._v(" "),t("el-form-item",{attrs:{prop:"userDisplayControl",label:"显示控制:"}},[t("el-select",{attrs:{size:"small"},model:{value:e.msgFormDialog.userDisplayControl,callback:function(a){e.$set(e.msgFormDialog,"userDisplayControl",a)},expression:"msgFormDialog.userDisplayControl"}},[t("el-option",{attrs:{label:"显示",value:1}}),e._v(" "),t("el-option",{attrs:{label:"不显示",value:2}}),e._v(" "),t("el-option",{attrs:{label:"前端不显示",value:3}})],1)],1),e._v(" "),t("el-form-item",{attrs:{label:"主备类型:"}},[t("el-select",{attrs:{size:"small"},model:{value:e.msgFormDialog.mainBakType,callback:function(a){e.$set(e.msgFormDialog,"mainBakType",a)},expression:"msgFormDialog.mainBakType"}},[t("el-option",{attrs:{label:"主库",value:1}}),e._v(" "),t("el-option",{attrs:{label:"备份库",value:2}})],1)],1),e._v(" "),t("el-form-item",{attrs:{label:"应用场景:"}},[t("el-input",{attrs:{size:"small",placeholder:"请输入应用场景"},model:{value:e.msgFormDialog.databaseDesc,callback:function(a){e.$set(e.msgFormDialog,"databaseDesc",a)},expression:"msgFormDialog.databaseDesc"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"总容量:",prop:"databaseCapacity"}},[t("el-input",{attrs:{size:"small",placeholder:"请输入总容量"},model:{value:e.msgFormDialog.databaseCapacity,callback:function(a){e.$set(e.msgFormDialog,"databaseCapacity",a)},expression:"msgFormDialog.databaseCapacity"}},[t("template",{slot:"append"},[e._v("TB")])],2)],1)],1)],1)],1),e._v(" "),t("el-tab-pane",{attrs:{label:"存储信息",name:"second"}},[t("el-row",{staticClass:"handleTableBox",attrs:{gutter:10}},[t("el-col",{attrs:{span:1.5}},[t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:e.addPhysicsStorage}},[e._v("添加")])],1),e._v(" "),t("el-col",{attrs:{span:1.5}},[t("el-button",{attrs:{type:"warning",size:"small",icon:"el-icon-delete"},on:{click:e.deletePhysicsStorage}},[e._v("删除")])],1),e._v(" "),t("el-col",{attrs:{span:1.5}},[t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-refresh"},on:{click:e.getPhysicsStorage}},[e._v("恢复")])],1)],1),e._v(" "),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.msgFormDialog.databaseNodesList,border:"",stripe:"","highlight-current-row":""},on:{"current-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),t("el-table-column",{attrs:{prop:"databaseNode",label:"节点列表"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{placeholder:"请输入节点IP"},model:{value:a.row.databaseNode,callback:function(t){e.$set(a.row,"databaseNode",t)},expression:"scope.row.databaseNode"}})]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"nodeRole",label:"节点角色"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-select",{attrs:{placeholder:"请选择"},model:{value:a.row.nodeRole,callback:function(t){e.$set(a.row,"nodeRole",t)},expression:"scope.row.nodeRole"}},[t("el-option",{attrs:{label:"存储节点",value:"存储节点"}}),e._v(" "),t("el-option",{attrs:{label:"管理节点",value:"管理节点"}})],1)]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"nodeState",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-select",{attrs:{placeholder:"请选择"},model:{value:a.row.nodeState,callback:function(t){e.$set(a.row,"nodeState",t)},expression:"scope.row.nodeState"}},[t("el-option",{attrs:{label:"使用中",value:"使用中"}}),e._v(" "),t("el-option",{attrs:{label:"停止使用",value:"停止使用"}}),e._v(" "),t("el-option",{attrs:{label:"已废弃",value:"已废弃"}})],1)]}}])})],1)],1),e._v(" "),t("el-tab-pane",{attrs:{label:"账户列表",name:"three"}},[t("el-form",[t("el-form-item",{staticClass:"manageBtn",staticStyle:{float:"right"}},[t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:e.addPhysicsUser}},[e._v("添加")]),e._v(" "),t("el-button",{attrs:{type:"warning",size:"small",icon:"el-icon-delete"},on:{click:e.deletePhysicsUser}},[e._v("删除")]),e._v(" "),t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-refresh"},on:{click:e.getPhysicsUser}},[e._v("恢复")])],1)],1),e._v(" "),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.msgFormDialog.databaseAdministratorList,border:"",stripe:"","highlight-current-row":""},on:{"current-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),t("el-table-column",{attrs:{prop:"userName",label:"登录用户"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:a.row.userName,callback:function(t){e.$set(a.row,"userName",t)},expression:"scope.row.userName"}})]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"2",label:"登录密码"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{"show-password":"",placeholder:"请输入密码"},model:{value:a.row.passWord,callback:function(t){e.$set(a.row,"passWord",t)},expression:"scope.row.passWord"}})]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"3",label:"开户目的"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{model:{value:a.row.introduction,callback:function(t){e.$set(a.row,"introduction",t)},expression:"scope.row.introduction"}})]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"3",label:"是否管理账户"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-select",{model:{value:a.row.isManager,callback:function(t){e.$set(a.row,"isManager",t)},expression:"scope.row.isManager"}},[t("el-option",{attrs:{label:"是",value:!0}}),e._v(" "),t("el-option",{attrs:{label:"否",value:!1}})],1)]}}])})],1)],1),e._v(" "),e.handleMsgObj.id?t("el-tab-pane",{attrs:{label:"专题列表",name:"four"}},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.physicsSpecialList,border:"",stripe:""}},[t("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),t("el-table-column",{attrs:{prop:"databaseName",label:"专题名"}}),e._v(" "),t("el-table-column",{attrs:{prop:"schemaName",label:"专题标识"}}),e._v(" "),t("el-table-column",{attrs:{prop:"userName",label:"关联web用户"}})],1)],1):e._e()],1),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer1"},slot:"footer1"},[t("el-button",{on:{click:function(a){return e.cancelDialog()}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.trueDialog("msgFormDialog")}}},[e._v("确 定")])],1)],1)},r=[],l=(t("55dd"),t("ac6a"),t("96cf"),t("3b8d")),o=t("ca31"),i=t("aa3a"),n=t("4b67"),m={name:"filedSearchDeploy",components:{},props:{handleMsgObj:{type:Object}},data:function(){var e=function(e,a,t){""===a?t(new Error("请输入数据库ID")):Object(n["d"])(a)?t():t(new Error("数据库ID只能由英文字母组成"))};return{dictsList:[],physicsSpecialList:[],currentRow:null,msgFormDialog:{databaseDto:{schemaName:"",databaseClassify:"物理库",databaseName:"基础库"},id:"",databaseName:"",serialNumber:"",databaseInstance:"",databaseType:"",driverClassName:"",databaseIp:"",databasePort:0,databaseUrl:"",upUrl:"",userDisplayControl:1,mainBakType:1,databaseDesc:"",databaseCapacity:0,databaseNodesList:[],databaseAdministratorList:[]},activeName:"first",flag:!1,isDbIdDisable:!1,baseFormRules:{id:{required:!0,validator:e,trigger:"blur"},databaseName:[{required:!0,message:"请输入数据库名称",trigger:"blur"}],serialNumber:[{required:!0,message:"请输入显示序号",trigger:"blur"},{type:"number",message:"显示序号必须为数字值"}],databaseInstance:[{required:!0,message:"数据库实例",trigger:"blur"}],databaseType:[{required:!0,message:"请输入数据库类型",trigger:"blur"}],driverClassName:[{required:!0,message:"请输入数据库驱动",trigger:"blur"}],databaseIp:[{required:!0,message:"请输入数据库IP",trigger:"blur"}],databasePort:[{required:!0,message:"请输入数据库端口",trigger:"blur"},{type:"number",message:"数据库端口必须为数字值"}],databaseUrl:[{required:!0,message:"请输入数据库访问地址",trigger:"blur"}],upUrl:[{required:!0,message:"请输入UP层访问地址",trigger:"blur"}],databaseCapacity:[{required:!0,message:"请输入总容量",trigger:"blur"}]}}},created:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getDictsList();case 2:this.handleMsgObj.id?(this.isDbIdDisable=!0,this.formDetail(this.handleMsgObj.id,"detail"),this.getPhysicsSpecial(this.msgFormDialog.id)):this.isDbIdDisable=!1;case 3:case"end":return e.stop()}}),e,this)})));function a(){return e.apply(this,arguments)}return a}(),methods:{getDictsList:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:Object(i["e"])("sys_database_type").then((function(e){200==e.code&&(a.dictsList=e.data)}));case 1:case"end":return e.stop()}}),e)})));function a(){return e.apply(this,arguments)}return a}(),trueDialog:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(a){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$refs[a].validate((function(e){if(e){t.msgFormDialog.databaseNodesList.forEach((function(e){e.databaseNode?t.$set(e,"databaseId",t.msgFormDialog.id):t.$message.error("请正确填写存储信息列表")})),t.msgFormDialog.databaseAdministratorList.forEach((function(e){e.userName&&e.passWord||t.$message.error("请正确填写账户信息列表")}));var a=[];t.msgFormDialog.databaseAdministratorList.some((function(e,t){a.push(e.userName)})),a.sort();for(var s=1;s<a.length;s++)if(a[s-1]===a[s])return void t.$message.error("用户名重复！");console.log(t.msgFormDialog),t.handleMsgObj||t.formDetail(t.msgFormDialog.id,"repeat"),t.flag?t.$message({message:"数据库ID重复",type:"error"}):Object(o["c"])(t.msgFormDialog).then((function(e){200==e.code?(t.$message({message:"操作成功",type:"success"}),t.cancelDialog()):(t.$message({message:e.msg,type:"error"}),t.cancelDialog())}))}else t.$message.error("请正确填写基本信息列表")}));case 1:case"end":return e.stop()}}),e,this)})));function a(a){return e.apply(this,arguments)}return a}(),formDetail:function(e,a){var t=this;Object(o["b"])({id:e}).then((function(e){"repeat"==a?e.data?t.flag=!0:t.flag=!1:(e.data.databaseDto||(e.data.databaseDto={schemaName:"",databaseClassify:"物理库",databaseName:"基础库"}),t.msgFormDialog=e.data)}))},cancelDialog:function(){this.$emit("cancelDialog")},handleSelectionChange:function(e){this.currentRow=e},checkParam:function(){var e=this;this.msgFormDialog.id?Object(o["a"])({id:this.msgFormDialog.id}).then((function(a){1==a.data.checkConn?e.$message({message:"连接正常",type:"success"}):e.$message({message:"连接异常",type:"error"})})):this.$message({message:"数据库ID不能为空",type:"error"})},getPhysicsStorage:function(){var e=this;this.msgFormDialog.databaseNodesList.forEach((function(a,t){a.id||e.msgFormDialog.databaseNodesList.splice(t,1)}))},addPhysicsStorage:function(){this.msgFormDialog.databaseNodesList.push({databaseNode:"",nodeRole:"存储节点",nodeState:"使用中"})},deletePhysicsStorage:function(){var e=this;if(this.currentRow){var a=this.currentRow.databaseNode;this.msgFormDialog.databaseNodesList.some((function(t,s){if(t.databaseNode==a)return e.msgFormDialog.databaseNodesList.splice(s,1),!0}))}else this.$message.error("请选择需要删除的记录！")},getPhysicsUser:function(){var e=this;this.msgFormDialog.databaseAdministratorList.forEach((function(a,t){a.id||e.msgFormDialog.databaseAdministratorList.splice(t,1)}))},addPhysicsUser:function(){this.msgFormDialog.databaseAdministratorList.push({userName:"",passWord:"",introduction:"",isManager:!0})},deletePhysicsUser:function(){var e=this;if(this.currentRow){var a=this.currentRow.userName;this.msgFormDialog.databaseAdministratorList.some((function(t,s){if(t.userName==a)return e.msgFormDialog.databaseAdministratorList.splice(s,1),!0}))}else this.$message.error("请选择需要删除的记录！")},getPhysicsSpecial:function(e){var a=this;Object(o["g"])({id:e}).then((function(e){200==e.code&&(a.physicsSpecialList=e.data)}))},pageTasChange:function(){this.currentRow=null}}},c=m,d=(t("2915"),t("2877")),u=Object(d["a"])(c,s,r,!1,null,null,null);a["default"]=u.exports}}]);