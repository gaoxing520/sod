(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-738f0134","chunk-0c4fbcdc","chunk-586108b5"],{"00fa":function(e,t,a){e.exports=a.p+"static/img/h3.42d0f93a.png"},"0e4d":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tabs",{staticClass:"handleMaterialDialog",on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"first"}},[a("el-form",{staticClass:"demo-form-inline",attrs:{model:e.formBaseInfo,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"用户名"}},[a("el-input",{attrs:{readonly:""},model:{value:e.formBaseInfo.USERREALNAME,callback:function(t){e.$set(e.formBaseInfo,"USERREALNAME",t)},expression:"formBaseInfo.USERREALNAME"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"机构"}},[a("el-input",{attrs:{readonly:""},model:{value:e.formBaseInfo.DEPARTMENT,callback:function(t){e.$set(e.formBaseInfo,"DEPARTMENT",t)},expression:"formBaseInfo.DEPARTMENT"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系方式"}},[a("el-input",{attrs:{readonly:""},model:{value:e.formBaseInfo.USERPHONE,callback:function(t){e.$set(e.formBaseInfo,"USERPHONE",t)},expression:"formBaseInfo.USERPHONE"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"申请时间"}},[a("el-input",{attrs:{readonly:""},model:{value:e.formBaseInfo.CREATE_TIME,callback:function(t){e.$set(e.formBaseInfo,"CREATE_TIME",t)},expression:"formBaseInfo.CREATE_TIME"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"数据库账户名"}},[a("el-input",{attrs:{readonly:""},model:{value:e.formBaseInfo.DATABASE_UP_ID,callback:function(t){e.$set(e.formBaseInfo,"DATABASE_UP_ID",t)},expression:"formBaseInfo.DATABASE_UP_ID"}})],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:22}},[a("el-form-item",{attrs:{label:"数据库账户密码"}},[a("el-input",{attrs:{readonly:"",type:e.passwordType,name:"password"},on:{blur:function(t){e.capsTooltip=!1}},model:{value:e.formBaseInfo.DATABASE_UP_PASSWORD,callback:function(t){e.$set(e.formBaseInfo,"DATABASE_UP_PASSWORD",t)},expression:"formBaseInfo.DATABASE_UP_PASSWORD"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"unitFormItem"},[a("i",{class:"password"===e.passwordType?"eye isEye":"el-icon-view isEye",on:{click:e.showPwd}})])],1)],1)],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"数据读写权限",name:"second"}},[a("el-alert",{attrs:{title:"申请状态：已申请"+e.tableData.length+"种资料,涉及"+e.tableData.length+"张表的读写权限， 审核通过"+e.AUTHORIZE_NUM+"张表, 审核不通过"+e.AUTHORIZEF_NUM+"张表",type:"success",closable:!1}}),e._v(" "),a("el-form",{ref:"queryForm",attrs:{model:e.queryParams,inline:!0}},[a("el-form-item",{attrs:{label:"关键字查询"}},[a("el-select",{attrs:{size:"small"},on:{change:e.changeSearch},model:{value:e.queryParams.searchSelect,callback:function(t){e.$set(e.queryParams,"searchSelect",t)},expression:"queryParams.searchSelect"}},[a("el-option",{attrs:{label:"资料分类",value:"typeName"}}),e._v(" "),a("el-option",{attrs:{label:"资料名称",value:"className"}}),e._v(" "),a("el-option",{attrs:{label:"表名称",value:"tableName"}}),e._v(" "),a("el-option",{attrs:{label:"数据库",value:"databaseName"}}),e._v(" "),a("el-option",{attrs:{label:"申请状态",value:"applyAuthority"}}),e._v(" "),a("el-option",{attrs:{label:"审核状态",value:"authorize"}}),e._v(" "),a("el-option",{attrs:{label:"专题名",value:"specialDatabaseName"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-input",{attrs:{size:"small",type:"text"},model:{value:e.queryParams.searchInput,callback:function(t){e.$set(e.queryParams,"searchInput",t)},expression:"queryParams.searchInput"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.handleQuery}},[e._v("查询")])],1)],1),e._v(" "),a("el-row",{staticClass:"mb8",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-thumb",size:"mini"},on:{click:e.handlePower}},[e._v("授权")]),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-close",size:"mini"},on:{click:e.handleRefused}},[e._v("拒接")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.tableData,"row-key":"id"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"TYPE_NAME",label:"资料分类","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"CLASS_NAME",label:"资料名称","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"TABLE_NAME",label:"表名称","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"DATABASE_NAME",label:"数据库","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"SPECIAL_DATABASE_NAME",label:"专题名","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"IS_ACCESS",label:"权限",width:"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return["0"==t.row.IS_ACCESS?a("span",[e._v("受限")]):a("span",[e._v("公开")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"APPLY_AUTHORITY",label:"申请状态",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return["1"==t.row.APPLY_AUTHORITY?a("span",[e._v("读申请")]):a("span",[e._v("读写申请")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"AUTHORIZE",label:"审核状态",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return["2"==t.row.AUTHORIZE?a("span",[a("i",{staticClass:"el-icon-circle-close",staticStyle:{color:"#F56C6C"}}),e._v("拒绝\n          ")]):"1"==t.row.AUTHORIZE?a("span",[a("i",{staticClass:"el-icon-circle-check",staticStyle:{color:"#67C23A"}}),e._v("通过\n          ")]):a("span",[a("i",{staticClass:"el-icon-s-finance",staticStyle:{color:"#E6A23C"}}),e._v("待审核\n          ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"CAUSE",label:"拒绝原因",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.CAUSE?a("el-popover",{attrs:{placement:"top",effect:"dark",trigger:"hover",width:"200","popper-class":"darkPopover"}},[a("p",[e._v(e._s(t.row.CAUSE))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("el-button",{staticClass:"tagpointer",attrs:{type:"primary",size:"mini",plain:""}},[e._v("查看")])],1)]):e._e()]}}])})],1)],1)],1)},s=[],o=(a("ac6a"),a("96cf"),a("3b8d")),r=a("e254"),n={name:"handleMaterialDialog",props:{handleObj:{type:Object}},data:function(){return{passwordType:"password",activeName:"first",formBaseInfo:{},queryParams:{},searchKey:"",loading:!1,tableData:[],total:0,AUTHORIZE_NUM:0,AUTHORIZEF_NUM:0,multipleSelection:[]}},created:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.queryParams.id=this.handleObj.id,!this.handleObj.id){e.next=4;break}return e.next=4,Object(r["a"])({id:this.handleObj.id}).then((function(e){200==e.code?t.formBaseInfo=e.data:t.msgError(e.msg)}));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{showPwd:function(){"password"===this.passwordType?this.passwordType="":this.passwordType="password"},handleClick:function(){"second"==this.activeName&&this.handleQuery()},handleSelectionChange:function(e){this.multipleSelection=e},changeSearch:function(e){this.searchKey=e},getList:function(e){var t=this;console.log(e),Object(r["c"])(e).then((function(e){200==e.code?(t.tableData=e.data,t.AUTHORIZE_NUM=0,t.AUTHORIZEF_NUM0=0,t.tableData.forEach((function(e){1==e.AUTHORIZE?t.AUTHORIZE_NUM++:2==e.AUTHORIZE&&t.AUTHORIZEF_NUM++}))):t.msgError(e.msg)}))},handleQuery:function(){var e=this.queryParams.searchInput;"applyAuthority"!=this.searchKey&&"authorize"!=this.searchKey||(e="读申请"==e||"通过"==e?"1":"读写申请"==e||"拒绝"==e?"2":"");var t={};t.applyId=this.queryParams.id,t[this.queryParams.searchSelect]=e,this.getList(t)},handlePower:function(){0!=this.multipleSelection.lenght?(console.log(this.multipleSelection),this.powerMethods()):this.msgError("请选择一条数据")},handleRefused:function(){var e=this;0!=this.multipleSelection.lenght?this.$prompt("请输入拒绝原因","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"拒绝原因不能为空"}).then((function(t){var a=t.value;e.powerMethods(a)})).catch((function(){})):this.msgError("请选择一条数据")},powerMethods:function(e){var t=this,a={userId:"admin",dataAuthorityRecordList:[]};this.multipleSelection.forEach((function(t){var l={};l.id=t.ID,l.applyId=t.APPLY_ID,l.databaseId=t.DATABASE_ID,l.applyAuthority=t.APPLY_AUTHORITY,l.authorize=e?2:1,l.dataClassId=t.DATA_CLASS_ID,l.cause=e,a.dataAuthorityRecordList.push(l)})),console.log(a),Object(r["f"])(JSON.parse(JSON.stringify(a))).then((function(a){200==a.code?(e?t.msgSuccess("拒绝成功"):t.msgSuccess("授权成功"),t.handleQuery()):t.msgError(a.msg)}))}}},i=n,c=(a("9fa9"),a("2877")),u=Object(c["a"])(i,l,s,!1,null,null,null);t["default"]=u.exports},1344:function(e,t,a){e.exports=a.p+"static/img/h5.c2a04329.png"},"2ad3":function(e,t,a){e.exports=a.p+"static/img/h15.ec5226c0.png"},"31b0":function(e,t,a){"use strict";var l=a("9eb9"),s=a.n(l);s.a},"51e5":function(e,t,a){e.exports=a.p+"static/img/h8.c07ce382.png"},"58a2":function(e,t,a){e.exports=a.p+"static/img/h14.d6dfbbee.png"},"61db":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"handleApply"},[a("el-steps",{attrs:{active:e.stepNum}},[a("el-step",{attrs:{title:"数据库访问账户",icon:"el-icon-menu"}}),e._v(" "),a("el-step",{directives:[{name:"show",rawName:"v-show",value:"1"==e.handleMsgObj.dbCreate,expression:"handleMsgObj.dbCreate=='1'"}],attrs:{title:"专题库",icon:"el-icon-s-ticket"}}),e._v(" "),a("el-step",{attrs:{title:"资料访问权限审核",icon:"el-icon-s-finance"}}),e._v(" "),a("el-step",{attrs:{title:"完成",icon:"el-icon-circle-check"}})],1),e._v(" "),0==e.stepNum?a("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[a("handleAccount",{ref:"AccountRef",attrs:{handleObj:e.handleObj},on:{handleDialogClose:e.handleClose}})],1):e._e(),e._v(" "),1==e.stepNum?a("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[a("handleLibrary",{ref:"LibraryRef",attrs:{handleObj:e.handleObj}})],1):e._e(),e._v(" "),2==e.stepNum?a("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[a("el-row",{staticClass:"mb8",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-thumb",size:"mini"},on:{click:e.handlePower}},[e._v("授权")]),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-close",size:"mini"},on:{click:e.handleRefused}},[e._v("拒接")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.tableData,"row-key":"id"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"TYPE_NAME",label:"资料分类","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"CLASS_NAME",label:"资料名称","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"TABLE_NAME",label:"表名称","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"DATABASE_NAME",label:"数据库","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"SPECIAL_DATABASE_NAME",label:"专题名","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"IS_ACCESS",label:"权限",width:"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return["0"==t.row.IS_ACCESS?a("span",[e._v("受限")]):a("span",[e._v("公开")])]}}],null,!1,3479694470)}),e._v(" "),a("el-table-column",{attrs:{prop:"APPLY_AUTHORITY",label:"申请状态",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return["1"==t.row.APPLY_AUTHORITY?a("span",[e._v("读申请")]):a("span",[e._v("读写申请")])]}}],null,!1,2299040014)}),e._v(" "),a("el-table-column",{attrs:{prop:"AUTHORIZE",label:"审核状态",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return["2"==t.row.AUTHORIZE?a("span",[a("i",{staticClass:"el-icon-circle-close",staticStyle:{color:"#F56C6C"}}),e._v("拒绝\n          ")]):"1"==t.row.AUTHORIZE?a("span",[a("i",{staticClass:"el-icon-circle-check",staticStyle:{color:"#67C23A"}}),e._v("通过\n          ")]):a("span",[a("i",{staticClass:"el-icon-s-finance",staticStyle:{color:"#E6A23C"}}),e._v("待审核\n          ")])]}}],null,!1,3462804020)}),e._v(" "),a("el-table-column",{attrs:{prop:"CAUSE",label:"拒绝原因",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.CAUSE?a("el-popover",{attrs:{placement:"top",effect:"dark",trigger:"hover",width:"200","popper-class":"darkPopover"}},[a("p",[e._v(e._s(t.row.CAUSE))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("el-button",{staticClass:"tagpointer",attrs:{type:"primary",size:"mini",plain:""}},[e._v("查看")])],1)]):e._e()]}}],null,!1,155540986)})],1)],1):e._e(),e._v(" "),3==e.stepNum?a("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[a("span",{staticStyle:{"font-size":"26px",display:"block","text-align":"center"}},[a("i",{staticClass:"el-icon-circle-check"}),e._v(" 完成\n    ")])]):e._e(),e._v(" "),a("div",{staticClass:"dialog-footer",staticStyle:{"margin-top":"20px"}},[3!=e.stepNum?a("el-button",{attrs:{type:"primary"},on:{click:e.nextStep}},[e._v("下一步")]):e._e(),e._v(" "),3==e.stepNum?a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$emit("closeStep")}}},[e._v("完成")]):e._e()],1)],1)},s=[],o=(a("ac6a"),a("96cf"),a("3b8d")),r=a("5d77"),n=a("c559"),i=a("0e4d"),c=a("e09d"),u=(a("e254"),a("84d7")),p={name:"handleApply",props:{handleMsgObj:{type:Object}},components:{handleAccount:r["default"],handleLibrary:n["default"],handleMaterial:i["default"]},data:function(){return{forId:"",loading:!1,tableData:[],multipleSelection:[],stepNum:0,msgFormDialog:{},handleObj:{pageName:"业务用户审核"}}},created:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.handleObj=Object.assign(this.handleMsgObj,this.handleObj);case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{initDatail:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c["a"])({userId:this.handleMsgObj.userName}).then((function(e){t.handleObj=e.data[0],t.forId=e.data[0].id,t.handleObj.pageName="业务用户审核",t.stepNum=1}));case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleClose:function(){},nextStep:function(){var e=this;if(0==this.stepNum)return"1"==this.handleMsgObj.dbCreate?void this.initDatail():void("1"==this.handleMsgObj.sodData&&Object(c["a"])({userId:this.handleMsgObj.userName}).then((function(t){e.forId=t.data[0].id,e.getList()})));1!=this.stepNum?2!=this.stepNum||(this.stepNum=3):this.getList()},getList:function(){var e=this,t={dataType:2,sdbId:this.forId};Object(u["h"])(t).then((function(t){200==t.code?(e.tableData=t.data,e.stepNum=2):e.msgError(t.msg)}))},handlePower:function(){0!=this.multipleSelection.lenght?(console.log(this.multipleSelection),this.powerMethods()):this.msgError("请选择一条数据")},handleRefused:function(){var e=this;0!=this.multipleSelection.lenght?this.$prompt("请输入拒绝原因","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"拒绝原因不能为空"}).then((function(t){var a=t.value;e.powerMethods(a)})).catch((function(){})):this.msgError("请选择一条数据")},powerMethods:function(e){var t=this,a={userId:"admin",dataAuthorityRecordList:[]};this.multipleSelection.forEach((function(t){var l={};l.id=t.ID,l.applyId=t.APPLY_ID,l.databaseId=t.DATABASE_ID,l.applyAuthority=t.APPLY_AUTHORITY,l.authorize=e?2:1,l.dataClassId=t.DATA_CLASS_ID,l.cause=e,a.dataAuthorityRecordList.push(l)})),console.log(a),updateRecordCheck(JSON.parse(JSON.stringify(a))).then((function(a){200==a.code?(e?t.msgSuccess("拒绝成功"):t.msgSuccess("授权成功"),t.handleQuery()):t.msgError(a.msg)}))},handleSelectionChange:function(e){this.multipleSelection=e}}},d=p,m=a("2877"),h=Object(m["a"])(d,l,s,!1,null,null,null);t["default"]=h.exports},"6d36":function(e,t,a){e.exports=a.p+"static/img/h12.9bc1d8f2.png"},"6f2b":function(e,t,a){e.exports=a.p+"static/img/h9.ffc51429.png"},"7ac9":function(e,t,a){e.exports=a.p+"static/img/h11.f105f083.png"},"7b00":function(e,t,a){},"84d7":function(e,t,a){"use strict";a.d(t,"i",(function(){return o})),a.d(t,"g",(function(){return r})),a.d(t,"f",(function(){return n})),a.d(t,"h",(function(){return i})),a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u})),a.d(t,"c",(function(){return p})),a.d(t,"d",(function(){return d})),a.d(t,"j",(function(){return m})),a.d(t,"e",(function(){return h}));var l=a("b775"),s="http://10.40.79.18:8005";function o(e){return Object(l["a"])({url:s+"/dm/databaseSpecial/page",method:"get",params:e})}function r(e){return Object(l["a"])({url:s+"/dm/databaseSpecial/getById",method:"get",params:e})}function n(e){return Object(l["a"])({url:s+"/dm/databaseSpecial/getAuthorityBySdbId",method:"get",params:e})}function i(e){return Object(l["a"])({url:s+"/dm/databaseSpecial/getSpecialDataList",method:"get",params:e})}function c(e){return Object(l["a"])({url:s+"/dm/databaseSpecial/delete",method:"delete",params:e})}function u(e){return Object(l["a"])({url:s+"/dm/databaseSpecial/empowerDataBatch",method:"post",data:e})}function p(e){return Object(l["a"])({url:s+"/dm/databaseSpecial/empowerDataOne",method:"post",data:e})}function d(e){return Object(l["a"])({url:s+"/dm/databaseSpecial/empowerDatabaseSpecial",method:"post",data:e})}function m(e){return Object(l["a"])({url:s+"/dm/databaseSpecial/save",method:"post",data:e})}function h(e){return Object(l["a"])({url:s+"/dm/fileUpDown/download",method:"get",params:e,responseType:"arraybuffer"})}},"89e9":function(e,t,a){e.exports=a.p+"static/img/h10.a63814ad.png"},9311:function(e,t,a){e.exports=a.p+"static/img/h7.b30eade7.png"},"9eb9":function(e,t,a){},"9fa9":function(e,t,a){"use strict";var l=a("7b00"),s=a.n(l);s.a},afa1:function(e,t,a){e.exports=a.p+"static/img/h2.ab690d33.png"},ba76:function(e,t,a){e.exports=a.p+"static/img/h13.c347a4c2.png"},c559:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"handleLiberyDialog"},[a("el-tabs",{attrs:{type:"border-card"}},[a("el-tab-pane",{attrs:{label:"基本信息"}},[a("el-form",{ref:"ruleForm",attrs:{model:e.msgFormDialog,"label-width":"100px"}},[e.handleObj.pageName?e._e():a("el-form-item",{attrs:{label:"图标"}},[e.sdbImg?a("img",{staticStyle:{width:"40px"},attrs:{src:e.sdbImg,alt:""}}):e._e()]),e._v(" "),a("el-form-item",{attrs:{label:"专题库名称"}},[a("el-input",{attrs:{size:"small"},model:{value:e.msgFormDialog.sdbName,callback:function(t){e.$set(e.msgFormDialog,"sdbName",t)},expression:"msgFormDialog.sdbName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用途"}},[a("el-input",{attrs:{size:"small"},model:{value:e.msgFormDialog.uses,callback:function(t){e.$set(e.msgFormDialog,"uses",t)},expression:"msgFormDialog.uses"}})],1),e._v(" "),e.handleObj.pageName?e._e():a("el-form-item",{attrs:{label:"创建人"}},[a("el-input",{attrs:{size:"small",disabled:!0},model:{value:e.msgFormDialog.userId,callback:function(t){e.$set(e.msgFormDialog,"userId",t)},expression:"msgFormDialog.userId"}})],1),e._v(" "),e.handleObj.pageName?e._e():a("el-form-item",{attrs:{label:"机构"}},[a("el-input",{attrs:{size:"small",disabled:!0},model:{value:e.msgFormDialog.department,callback:function(t){e.$set(e.msgFormDialog,"department",t)},expression:"msgFormDialog.department"}})],1),e._v(" "),e.handleObj.pageName?e._e():a("el-form-item",{attrs:{label:"联系方式"}},[a("el-input",{attrs:{size:"small",disabled:!0},model:{value:e.msgFormDialog.phoneNum,callback:function(t){e.$set(e.msgFormDialog,"phoneNum",t)},expression:"msgFormDialog.phoneNum"}})],1),e._v(" "),e.handleObj.pageName?e._e():a("el-form-item",{attrs:{label:"申请材料"}},[a("el-button",{attrs:{disabled:!e.msgFormDialog.applyMaterial,size:"small",type:"success",icon:"el-icon-document"},on:{click:e.handleExport}},[e._v("下载")])],1),e._v(" "),a("el-form-item",{attrs:{label:"排序"}},[a("el-input",{attrs:{size:"small"},model:{value:e.msgFormDialog.sortNo,callback:function(t){e.$set(e.msgFormDialog,"sortNo",t)},expression:"msgFormDialog.sortNo"}})],1),e._v(" "),a("div",{staticClass:"dialog-footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.trueDialog("ruleForm")}}},[e._v("保 存")])],1)],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"数据库授权"}},[a("el-form",[a("el-row",{staticClass:"center"},[a("el-col",{attrs:{span:24}},[a("span",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(this.msgFormDialog.sdbName))])])],1),e._v(" "),a("el-row",{staticClass:"center"},[a("el-col",{attrs:{span:24}},[a("span",[e._v("专题库英文简称:")]),e._v(" "),a("span",[e._v(e._s(this.msgFormDialog.simpleName))])])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.databaseList,border:"",stripe:""}},[a("el-table-column",{attrs:{prop:"databaseId",label:"数据库"}}),e._v(" "),a("el-table-column",{attrs:{label:"权限"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-checkbox-group",{model:{value:t.row.checkList,callback:function(a){e.$set(t.row,"checkList",a)},expression:"scope.row.checkList"}},[a("el-checkbox",{attrs:{label:"createTable"}},[e._v("创建")]),e._v(" "),a("el-checkbox",{attrs:{label:"deleteTable"}},[e._v("删除")]),e._v(" "),a("el-checkbox",{attrs:{label:"tableDataAccess"}},[e._v("读写")])],1)]}}])})],1),e._v(" "),a("el-row",[a("el-col",{staticStyle:{"text-align":"center","margin-top":"10px"}},[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-thumb"},on:{click:e.addPhysicsDefine}},[e._v("数据库授权")])],1)],1)],1)],1),e._v(" "),e.handleObj.pageName?e._e():a("el-tab-pane",{attrs:{label:"专题库资料"}},[a("section",{staticClass:"searchCon"},[a("el-form",{ref:"modelForm",staticClass:"funLoad selSearchCon",attrs:{inline:!0,model:e.searchLibraryObj}},[a("el-form-item",{attrs:{label:"关键字查询"}},[a("el-select",{attrs:{size:"small"},model:{value:e.searchLibraryObj.key,callback:function(t){e.$set(e.searchLibraryObj,"key",t)},expression:"searchLibraryObj.key"}},[a("el-option",{attrs:{label:"资料分类",value:"typeName"}}),e._v(" "),a("el-option",{attrs:{label:"资料名称",value:"dataName"}}),e._v(" "),a("el-option",{attrs:{label:"表名称",value:"tableName"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-input",{attrs:{size:"small",type:"text"},model:{value:e.searchLibraryObj.valueText,callback:function(t){e.$set(e.searchLibraryObj,"valueText",t)},expression:"searchLibraryObj.valueText"}})],1),e._v(" "),a("el-form-item",{staticClass:"handleSearchBtn"},[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.searchLibraryFun}},[e._v("查询")])],1)],1)],1),e._v(" "),a("section",{staticClass:"loadTable"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableLibraryData,border:""}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"typeName",label:"资料分类","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"dataName",label:"资料名称","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"ddataId",label:"四级编码","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"tableName",label:"表名称","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"databaseName",label:"数据库","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"applyAuthority",label:"申请权限",width:"80",formatter:e.applyAuthFormatter}})],1)],1)]),e._v(" "),e.handleObj.pageName?e._e():a("el-tab-pane",{attrs:{label:"基础库资料"}},[a("section",{staticClass:"searchCon"},[a("el-form",{ref:"modelForm",staticClass:"funLoad selSearchCon",attrs:{inline:!0,model:e.searchBaseLibraryObj}},[a("el-form-item",{attrs:{label:"关键字查询"}},[a("el-select",{attrs:{size:"small"},model:{value:e.searchBaseLibraryObj.key,callback:function(t){e.$set(e.searchBaseLibraryObj,"key",t)},expression:"searchBaseLibraryObj.key"}},[a("el-option",{attrs:{label:"资料分类",value:"typeName"}}),e._v(" "),a("el-option",{attrs:{label:"资料名称",value:"dataName"}}),e._v(" "),a("el-option",{attrs:{label:"表名称",value:"tableName"}}),e._v(" "),a("el-option",{attrs:{label:"申请权限",value:"applyAuthority"}}),e._v(" "),a("el-option",{attrs:{label:"审核状态",value:"empowerAuthority"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-input",{attrs:{size:"small",type:"text"},model:{value:e.searchBaseLibraryObj.valueText,callback:function(t){e.$set(e.searchBaseLibraryObj,"valueText",t)},expression:"searchBaseLibraryObj.valueText"}})],1),e._v(" "),a("el-form-item",{staticClass:"handleSearchBtn"},[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.loadReadList}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-thumb"},on:{click:function(t){return e.batchUpdatePower("1")}}},[e._v("授权")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-close"},on:{click:function(t){return e.batchUpdatePower("2")}}},[e._v("拒绝")])],1)],1)],1),e._v(" "),a("section",{staticClass:"loadTable"},[a("el-table",{attrs:{data:e.baseTableLibraryData,border:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"45"}}),e._v(" "),a("el-table-column",{attrs:{prop:"typeName",label:"资料分类","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"dataName",label:"资料名称","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"ddataId",label:"四级编码","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"tableName",label:"表名称","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"databaseName",label:"数据库","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"applyAuthority",width:"80px",label:"申请权限",formatter:e.applyAuthFormatter}}),e._v(" "),a("el-table-column",{attrs:{prop:"empowerAuthority",label:"审核状态"},scopedSlots:e._u([{key:"default",fn:function(t){return["1"==t.row.empowerAuthority?a("el-link",{attrs:{underline:!1,size:"small",type:"success",icon:"el-icon-check"}},[e._v("已授权")]):a("el-link",{attrs:{underline:!1,size:"small",type:"danger",icon:"el-icon-close"}},[e._v("已撤销")])]}}],null,!1,2569904908)}),e._v(" "),a("el-table-column",{attrs:{prop:"examine_status",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",[e._v(e._s(t.row.failureReason))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{attrs:{size:"medium"}},[e._v("查看")])],1)])]}}],null,!1,3453803811)}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"240px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{plain:"",type:"primary",size:"mini",icon:"el-icon-thumb"},on:{click:function(a){return e.updatePower(t.row,"1")}}},[e._v("授权")]),e._v(" "),a("el-button",{attrs:{plain:"",type:"danger",size:"mini",icon:"el-icon-close"},on:{click:function(a){return e.updatePower(t.row,"2")}}},[e._v("拒绝")])]}}],null,!1,1638602640)})],1)],1)])],1)],1)},s=[],o=(a("ac6a"),a("84d7")),r=(a("e09d"),{name:"handleLiberyDialog",props:{handleObj:{type:Object}},data:function(){return{msgFormDialog:{},searchLibraryObj:{key:"typeName",valueText:""},searchBaseLibraryObj:{key:"typeName",valueText:""},baseTableLibraryData:[],tableLibraryData:[],databaseList:[],multipleSelection:[],paramList:[],refuseReasonDialog:!1,refusereason:"",single:!1,sdbImg:"",dialogImageUrlData:[a("dde0"),a("afa1"),a("00fa"),a("d4c8"),a("1344"),a("d0e7"),a("9311"),a("51e5"),a("6f2b"),a("89e9"),a("7ac9"),a("6d36"),a("ba76"),a("58a2"),a("2ad3")]}},created:function(){this.handleObj.id&&(console.log(this.handleObj),this.initDetail()),this.searchLibraryFun(),this.loadReadList()},methods:{applyAuthFormatter:function(e,t){return"1"==e.applyAuthority?"只读":"2"==e.applyAuthority?"读写":void 0},handleExport:function(){var e=this;Object(o["e"])({filePath:this.msgFormDialog.applyMaterial}).then((function(t){t.code?e.$message({type:"warning",message:t.msg}):e.downloadfileCommon(t)}))},initDetail:function(){var e=this;Object(o["g"])({id:this.handleObj.id}).then((function(t){200==t.code&&(e.msgFormDialog=t.data,e.msgFormDialog.applyMaterial||e.handleObj.pageName||e.$message({type:"danger",message:"文件不存在"}))})),Object(o["f"])({sdbId:this.handleObj.id}).then((function(t){200==t.code&&t.data&&t.data.length>0&&(e.databaseList=t.data,e.databaseList.forEach((function(t,a){e.$set(t,"checkList",[]),"2"==t.createTable&&t.checkList.push("createTable"),"2"==t.deleteTable&&t.checkList.push("deleteTable"),"2"==t.tableDataAccess&&t.checkList.push("tableDataAccess")})))}))},trueDialog:function(){var e=this;Object(o["j"])(this.msgFormDialog).then((function(t){200==t.code?(e.$emit("closedialog"),e.$message({type:"success",message:"保存成功"})):e.$message({type:"error",message:t.msg})}))},searchLibraryFun:function(){var e=this,t={dataType:1,sdbId:this.handleObj.id};this.searchLibraryObj.valueText&&(t[this.searchLibraryObj.key]=this.searchLibraryObj.valueText),console.log(t),Object(o["h"])(t).then((function(t){e.tableLibraryData=t.data}))},loadReadList:function(){var e=this,t={dataType:2,sdbId:this.handleObj.id};this.searchBaseLibraryObj.valueText&&(t[this.searchBaseLibraryObj.key]=this.searchBaseLibraryObj.valueText),console.log(t),Object(o["h"])(t).then((function(t){e.baseTableLibraryData=t.data}))},addPhysicsDefine:function(){var e=this,t={},a=this.databaseList;a.forEach((function(e){var t=e.checkList;t.forEach((function(t){e[t]&&(e[t]=2)}))})),t.databaseSpecialAuthorityList=a,t.databaseId=this.msgFormDialog.databaseId,t.sdbId=this.msgFormDialog.id,t.sdbName=this.msgFormDialog.sdbName,t.simpleName=this.msgFormDialog.simpleName,t.userId=this.msgFormDialog.userId,console.log(t),Object(o["d"])(t).then((function(t){200==t.code&&(e.$message({type:"success",message:"授权成功"}),e.databaseList=[],e.initDetail(),e.searchLibraryFun(),e.loadReadList())}))},handleSelectionChange:function(e){this.multipleSelection=e},updatePower:function(e,t){var a=this;e.examineStatus=t,"2"==t?this.$prompt("请输入拒绝原因","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(t){var l=t.value;e.failureReason=l,a.editPowerOne(e)})).catch((function(){})):this.editPowerOne(e)},editPowerOne:function(e){var t=this;console.log(e),Object(o["c"])(e).then((function(e){200==e.code?(t.$message({type:"success",message:"授权成功"}),t.loadReadList()):t.$message({type:"error",message:"授权失败"})}))},batchUpdatePower:function(e){var t=this;this.multipleSelection.length>0?"2"==e?this.$prompt("请输入拒绝原因","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(e){var a=e.value;t.multipleSelection.forEach((function(e){e.failureReason=a,e.examineStatus=2})),t.editPowerBath()})).catch((function(){})):(this.multipleSelection.forEach((function(e){e.examineStatus=1})),this.editPowerBath()):this.$message({type:"warning",message:"请勾选需要操作的资料"})},editPowerBath:function(){var e=this;console.log(this.multipleSelection),Object(o["b"])(this.multipleSelection).then((function(t){200==t.code?(e.$message({type:"success",message:"授权成功"}),e.loadReadList()):e.$message({type:"error",message:"授权失败"})}))}}}),n=r,i=(a("31b0"),a("2877")),c=Object(i["a"])(n,l,s,!1,null,null,null);t["default"]=c.exports},d0e7:function(e,t,a){e.exports=a.p+"static/img/h6.622ca2de.png"},d4c8:function(e,t,a){e.exports=a.p+"static/img/h4.f54d5416.png"},dde0:function(e,t,a){e.exports=a.p+"static/img/h1.1bc196c8.png"},e09d:function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return r}));var l=a("b775"),s="http://10.40.79.18:8005";function o(e){return Object(l["a"])({url:s+"/system/user/gatAllBiz",method:"get",params:e})}function r(e){return Object(l["a"])({url:s+"/dm/databaseSpecial/findByUserId",method:"get",params:e})}},e254:function(e,t,a){"use strict";a.d(t,"d",(function(){return o})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return n})),a.d(t,"f",(function(){return i})),a.d(t,"b",(function(){return c})),a.d(t,"e",(function(){return u}));var l=a("b775"),s="http://10.40.79.18:8005";function o(e){return Object(l["a"])({url:s+"/dm/dataAuthorityApply/list",method:"get",params:e})}function r(e){return Object(l["a"])({url:s+"/dm/dataAuthorityApply/getApplyInfoById",method:"get",params:e})}function n(e){return Object(l["a"])({url:s+"/dm/dataAuthorityApply/getRecordByApplyId",method:"get",params:e})}function i(e){return Object(l["a"])({url:s+"/dm/dataAuthorityApply/updateRecordCheck",method:"PUT",data:e})}function c(e){return Object(l["a"])({url:s+"/dm/dataAuthorityApply/getReadAuthority",method:"get",params:e})}function u(e){return Object(l["a"])({url:s+"/dm/dataAuthorityApply/updateReadAuthority",method:"post",data:e})}}}]);