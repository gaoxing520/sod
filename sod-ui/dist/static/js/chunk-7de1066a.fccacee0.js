(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7de1066a","chunk-176edc92"],{"2c2d":function(e,t,a){"use strict";var o=a("4975"),l=a.n(o);l.a},3069:function(e,t,a){"use strict";var o=a("ec01"),l=a.n(o);l.a},4975:function(e,t,a){},"70bc":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"handleExport"},[a("el-form",{ref:"ruleForm",attrs:{rules:e.rules,model:e.msgFormDialog,"label-width":"140px"}},[a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"任务名称",prop:"taskName"}},[a("el-input",{attrs:{size:"small"},model:{value:e.msgFormDialog.taskName,callback:function(t){e.$set(e.msgFormDialog,"taskName",t)},expression:"msgFormDialog.taskName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"数据库IP"}},[a("el-select",{attrs:{size:"small",filterable:""},on:{change:e.findTree},model:{value:e.msgFormDialog.databaseId,callback:function(t){e.$set(e.msgFormDialog,"databaseId",t)},expression:"msgFormDialog.databaseId"}},e._l(e.ipList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.VAULE,value:e.KEY}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"类型",prop:"checked"}},[a("el-checkbox-group",{model:{value:e.msgFormDialog.checked,callback:function(t){e.$set(e.msgFormDialog,"checked",t)},expression:"msgFormDialog.checked"}},[a("el-checkbox",{attrs:{label:"结构"}},[e._v("结构")]),e._v(" "),a("el-checkbox",{attrs:{label:"数据"}},[e._v("数据")])],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:20}},[a("el-form-item",{attrs:{label:"执行策略",prop:"jobCron"}},[a("el-input",{attrs:{size:"small"},model:{value:e.msgFormDialog.jobCron,callback:function(t){e.$set(e.msgFormDialog,"jobCron",t)},expression:"msgFormDialog.jobCron"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:4}},[a("el-form-item",{staticClass:"unitFormItem"},[a("el-button",{staticStyle:{padding:"9px 0",width:"100%"},attrs:{size:"small",type:"primary"},on:{click:function(t){e.cronDialogVisible=!0}}},[e._v("配置策略")])],1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"存储目录"}},[a("el-select",{attrs:{size:"small",filterable:""},model:{value:e.msgFormDialog.storageDirectory,callback:function(t){e.$set(e.msgFormDialog,"storageDirectory",t)},expression:"msgFormDialog.storageDirectory"}},e._l(e.storageDirectoryOptions,(function(e){return a("el-option",{key:e.dictValue,attrs:{label:e.dictLabel,value:e.dictValue}})})),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:14}},[a("el-form-item",{attrs:{label:"数据库对象"}},[a("el-scrollbar",{attrs:{"wrap-class":"scrollbar-wrapper"}},[a("el-tree",{ref:"eltree",attrs:{"node-key":"nodeKey","show-checkbox":"",data:e.treedata,props:e.defaultProps,"default-checked-keys":e.defaultChecked}})],1)],1)],1)],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.msgFormDialog.conditions,expression:"msgFormDialog.conditions"}],attrs:{label:"where条件"}},[a("el-input",{attrs:{size:"small",disabled:!0},model:{value:e.msgFormDialog.conditions,callback:function(t){e.$set(e.msgFormDialog,"conditions",t)},expression:"msgFormDialog.conditions"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.trueDialog("ruleForm","handExe")}}},[e._v("手工执行元数据备份")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.trueDialog("ruleForm","handtrue")}}},[e._v("确 定")]),e._v(" "),a("el-button",{on:{click:function(t){return e.cancelDialog("ruleForm")}}},[e._v("取 消")])],1),e._v(" "),e.cronDialogVisible?a("Cron",{attrs:{"append-to-body":"",cronDialogVisible:e.cronDialogVisible},on:{closeCron:e.closeCron,setCron:e.setCron}}):e._e()],1)},l=[],r=(a("ac6a"),a("28a5"),a("96cf"),a("3b8d")),i=a("3d09"),n=a("4b67"),s=a("9600"),c={name:"handleExport",props:{handleObj:{type:Object}},components:{Cron:i["a"]},data:function(){return{treeJson:[],storageDirectoryOptions:[],cronDialogVisible:!1,defaultChecked:[],msgFormDialog:{taskName:"",databaseId:"",checked:[],jobCron:"",storageDirectory:"",conditions:""},ipList:[],defaultProps:{children:"children",label:"name"},treedata:[],rules:{taskName:[{required:!0,message:"请输入任务名称",trigger:"blur"}],databaseId:[{required:!0,message:"请选择数据库IP",trigger:"change"}],checked:[{required:!0,message:"请选择类型",trigger:"change"}],jobCron:[{required:!0,message:"请输入执行策略",trigger:"blur"}],storageDirectory:[{required:!0,message:"请选择存储目录",trigger:"change"}]}}},created:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a,o=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(s["h"])().then((function(e){o.ipList=e.data}));case 2:return e.next=4,this.getDicts("metabackup_storage_directory").then((function(e){o.storageDirectoryOptions=e.data}));case 4:if(!this.handleObj.id){e.next=15;break}return this.msgFormDialog=this.handleObj,this.msgFormDialog.checked=[],t=this.msgFormDialog.isStructure.split(","),t.forEach((function(e){"0"==e&&o.msgFormDialog.checked.push("结构"),"1"==e&&o.msgFormDialog.checked.push("数据")})),e.next=11,this.findTree(this.msgFormDialog.databaseId);case 11:a=JSON.parse(this.msgFormDialog.backContent),this.defaultChecked=[],a.forEach((function(e){o.treeJson.forEach((function(t){e.nodeKey==t.nodeKey&&o.defaultChecked.push(e.nodeKey)}))})),console.log(this.defaultChecked);case 15:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{findTree:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(s["i"])({databaseId:t}).then((function(e){a.treeJson=e.data,a.treeJson.forEach((function(e){e.nodeKey=e.pid+"+"+e.id})),a.treedata=Object(n["h"])(a.treeJson,""),console.log(a.treedata)}));case 2:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),handExe:function(e){this.msgFormDialog.triggerStatus=1},trueDialog:function(e,t){var a=this;this.msgFormDialog.triggerStatus=1;var o=this.$refs.eltree.getHalfCheckedKeys(),l=this.$refs.eltree.getCheckedKeys();if(0!=l.length){var r=[];l.forEach((function(e){a.treeJson.forEach((function(t){if(e==t.nodeKey){var a={};a=t,r.push(a)}}))})),o.forEach((function(e){a.treeJson.forEach((function(t){if(e==t.nodeKey){var a={};a=t,r.push(a)}}))})),this.msgFormDialog.backContent=JSON.stringify(r),this.msgFormDialog.isStructure=[],this.msgFormDialog.checked.forEach((function(e){"结构"==e&&a.msgFormDialog.isStructure.push("0"),"数据"==e&&a.msgFormDialog.isStructure.push("1")})),this.msgFormDialog.isStructure=this.msgFormDialog.isStructure.join(","),console.log(this.msgFormDialog),this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;"handtrue"==t?a.handleObj.id?Object(s["d"])(a.msgFormDialog).then((function(e){200===e.code?(a.msgSuccess("修改成功"),a.$emit("cancelHandle")):a.msgError(e.msg)})):Object(s["a"])(a.msgFormDialog).then((function(e){200===e.code?(a.msgSuccess("新增成功"),a.$emit("cancelHandle")):a.msgError(e.msg)})):a.$prompt("请输入where条件","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(e){var t=e.value;a.msgFormDialog.conditions=t,Object(s["j"])(a.msgFormDialog).then((function(e){200===e.code?(a.msgSuccess("新增成功"),a.$emit("cancelHandle")):a.msgError(e.msg)}))})).catch((function(){}))}))}else this.msgError("请选择数据库对象")},cancelDialog:function(e){this.$emit("cancelHandle")},setCron:function(e){this.msgFormDialog.jobCron=e,this.cronDialogVisible=!1},closeCron:function(){this.cronDialogVisible=!1}}},u=c,m=(a("3069"),a("2877")),d=Object(m["a"])(u,o,l,!1,null,null,null);t["default"]=d.exports},9600:function(e,t,a){"use strict";a.d(t,"h",(function(){return r})),a.d(t,"n",(function(){return i})),a.d(t,"m",(function(){return n})),a.d(t,"o",(function(){return s})),a.d(t,"e",(function(){return c})),a.d(t,"p",(function(){return u})),a.d(t,"i",(function(){return m})),a.d(t,"a",(function(){return d})),a.d(t,"d",(function(){return g})),a.d(t,"j",(function(){return h})),a.d(t,"k",(function(){return p})),a.d(t,"l",(function(){return f})),a.d(t,"b",(function(){return b})),a.d(t,"c",(function(){return v})),a.d(t,"g",(function(){return D})),a.d(t,"f",(function(){return k}));var o=a("b775"),l="http://10.40.79.18:8005";function r(){return Object(o["a"])({url:l+"/schedule/metaBackup/findDataBase",method:"get"})}function i(e){return Object(o["a"])({url:l+"/schedule/metaBackup/list",method:"get",params:e})}function n(e){return Object(o["a"])({url:l+"/schedule/metaBackup/"+e,method:"DELETE"})}function s(e){return Object(o["a"])({url:l+"/schedule/job/startById",method:"get",params:{id:e}})}function c(e){return Object(o["a"])({url:l+"/schedule/job/execute",method:"get",params:{id:e}})}function u(e){return Object(o["a"])({url:l+"/schedule/job/stop",method:"get",params:{id:e}})}function m(e){return Object(o["a"])({url:l+"/schedule/metaBackup/findMeta",method:"get",params:e})}function d(e){return Object(o["a"])({url:l+"/schedule/metaBackup",method:"post",data:e})}function g(e){return Object(o["a"])({url:l+"/schedule/metaBackup",method:"put",data:e})}function h(e){return Object(o["a"])({url:l+"/schedule/metaBackup/handExecute",method:"get",params:e})}function p(e){return Object(o["a"])({url:l+"/schedule/metaBackupLog/list",method:"get",params:e})}function f(e){return Object(o["a"])({url:l+"/schedule/metaBackupLog/"+e,method:"get"})}function b(e){return Object(o["a"])({url:l+"/schedule/metaBackupLog/"+e,method:"delete"})}function v(e){return Object(o["a"])({url:l+"/api/schedule/uploadDown/downFile",method:"get",params:e,responseType:"arraybuffer"})}function D(e){return Object(o["a"])({url:l+"/schedule/metaBackupLog/export",method:"get",params:e,responseType:"arraybuffer"})}function k(e){return Object(o["a"])({url:l+"/schedule/metaBackup/export",method:"get",params:e,responseType:"arraybuffer"})}},d6b9:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container metadataBackupTem"},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"元数据备份配置",name:"first"}},[a("el-form",{staticClass:"searchBox",attrs:{model:e.queryParams,inline:!0}},[a("el-form-item",{attrs:{label:"数据库IP"}},[a("el-select",{staticStyle:{width:"200px"},attrs:{size:"small",filterable:""},model:{value:e.queryParams.databaseId,callback:function(t){e.$set(e.queryParams,"databaseId",t)},expression:"queryParams.databaseId"}},e._l(e.ipList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.VAULE,value:e.KEY}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"任务名称"}},[a("el-input",{attrs:{size:"small"},model:{value:e.queryParams.taskName,callback:function(t){e.$set(e.queryParams,"taskName",t)},expression:"queryParams.taskName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"任务状态"}},[a("el-select",{staticStyle:{width:"200px"},attrs:{size:"small",filterable:""},model:{value:e.queryParams.triggerStatus,callback:function(t){e.$set(e.queryParams,"triggerStatus",t)},expression:"queryParams.triggerStatus"}},[a("el-option",{attrs:{value:" ",label:"全部"}}),e._v(" "),a("el-option",{attrs:{value:"0",label:"停止"}}),e._v(" "),a("el-option",{attrs:{value:"1",label:"启动"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.handleQuery}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{size:"small",icon:"el-icon-refresh-right"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1),e._v(" "),a("el-row",{staticClass:"handleTableBox",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:e.handleAdd}},[e._v("添加")])],1),e._v(" "),a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.deleteShow()}}},[e._v("删除同步任务")])],1),e._v(" "),a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-download"},on:{click:e.handleExport}},[e._v("导出")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.tableData,"row-key":"id","highlight-current-row":""},on:{"selection-change":e.handleTaskSelectionChange}},[a("el-table-column",{attrs:{type:"index",width:"40",index:e.table_index}}),e._v(" "),a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"taskName",label:"任务名称","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"storageDirectory",label:"存储目录","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"databaseName",label:"数据库","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"jobCron",label:"执行策略","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"isStructure",label:"类型",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.isStructure?a("span",[e._v("结构")]):e._e(),e._v(" "),1==t.row.isStructure?a("span",[e._v("数据")]):e._e(),e._v(" "),"0,1"==t.row.isStructure?a("span",[e._v("数据，结构")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"triggerStatus",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.triggerStatus?a("el-link",{attrs:{icon:"el-icon-circle-close",type:"danger",underline:!1}},[e._v("停止")]):e._e(),e._v(" "),1==t.row.triggerStatus?a("el-link",{attrs:{icon:"el-icon-circle-check",type:"success",underline:!1}},[e._v("启动")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"360px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-edit"},on:{click:function(a){return e.showEditDialog(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-video-pause",disabled:0==t.row.triggerStatus},on:{click:function(a){return e.handleTask(t.row,"停止")}}},[e._v("停止")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-video-pause",disabled:1==t.row.triggerStatus},on:{click:function(a){return e.handleTask(t.row,"启动")}}},[e._v("启动")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-thumb"},on:{click:function(a){return e.handleTask(t.row,"立即执行")}}},[e._v("立即执行")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-reading"},on:{click:function(a){return e.viewDaily(t.row)}}},[e._v("查询日志")])]}}])})],1),e._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getMetaBackupList}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"元数据备份监控",name:"second"}},[a("el-form",{ref:"rowlogForm",staticClass:"searchBox",attrs:{model:e.rowlogForm,inline:!0}},[a("el-form-item",{attrs:{label:"数据库IP"}},[a("el-select",{staticStyle:{width:"200px"},attrs:{filterable:""},model:{value:e.rowlogForm.name,callback:function(t){e.$set(e.rowlogForm,"name",t)},expression:"rowlogForm.name"}},e._l(e.ipList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.VAULE,value:e.KEY}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"任务名称"}},[a("el-input",{attrs:{size:"small"},model:{value:e.rowlogForm.taskName,callback:function(t){e.$set(e.rowlogForm,"taskName",t)},expression:"rowlogForm.taskName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"时间范围"}},[a("el-date-picker",{staticStyle:{width:"300px"},attrs:{type:"datetimerange","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.queryListLog}},[e._v("查询")])],1)],1),e._v(" "),a("el-row",{staticClass:"handleTableBox",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-download"},on:{click:e.handleLogExport}},[e._v("导出")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingHis,expression:"loadingHis"}],ref:"multipleTable",attrs:{data:e.logTableData,"highlight-current-row":""},on:{"selection-change":e.handleHistorySelectionChange}},[a("el-table-column",{attrs:{type:"index",width:"40",index:e.table_index_log}}),e._v(" "),a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"taskName",label:"任务名称","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"storageDirectory",label:"存储目录","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"databaseName",label:"数据库","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{width:"200px",prop:"handleTime",label:"运行开始时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.parseTime(t.row.handleTime)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"isStructure",label:"类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.isStructure?a("span",[e._v("结构")]):e._e(),e._v(" "),1==t.row.isStructure?a("span",[e._v("数据")]):e._e(),e._v(" "),"0,1"==t.row.isStructure?a("span",[e._v("数据，结构")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"状态",prop:"handleCode",formatter:e.statusFormat}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"240px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-reading"},on:{click:function(a){return e.showDetailDialog(t.row)}}},[e._v("查看详情")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-download"},on:{click:function(a){return e.handleFileExport(t.row)}}},[e._v("导出")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-delete"},on:{click:function(a){return e.deleteLog(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.logDataTotal>0,expression:"logDataTotal>0"}],attrs:{total:e.logDataTotal,page:e.rowlogForm.pageNum,limit:e.rowlogForm.pageSize},on:{"update:page":function(t){return e.$set(e.rowlogForm,"pageNum",t)},"update:limit":function(t){return e.$set(e.rowlogForm,"pageSize",t)},pagination:e.getListLog}})],1)],1),e._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:e.dialogTitle,visible:e.handleDialog,width:"70%"},on:{"update:visible":function(t){e.handleDialog=t}}},[e.handleDialog?a("handleExportD",{attrs:{handleObj:e.handleObj},on:{cancelHandle:e.cancelHandle}}):e._e()],1),e._v(" "),e.logDetailDialog?a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"详情",visible:e.logDetailDialog,width:"1000px"},on:{"update:visible":function(t){e.logDetailDialog=t}}},[a("el-form",{ref:"ruleForm",attrs:{model:e.logFormDialog,"label-width":"140px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"任务名称"}},[a("el-input",{attrs:{size:"small"},model:{value:e.logFormDialog.taskName,callback:function(t){e.$set(e.logFormDialog,"taskName",t)},expression:"logFormDialog.taskName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"数据库IP"}},[a("el-select",{attrs:{size:"small",filterable:""},model:{value:e.logFormDialog.databaseId,callback:function(t){e.$set(e.logFormDialog,"databaseId",t)},expression:"logFormDialog.databaseId"}},e._l(e.ipList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.VAULE,value:e.KEY}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"类型"}},[a("el-checkbox-group",{model:{value:e.logFormDialog.checked,callback:function(t){e.$set(e.logFormDialog,"checked",t)},expression:"logFormDialog.checked"}},[a("el-checkbox",{attrs:{label:"结构"}},[e._v("结构")]),e._v(" "),a("el-checkbox",{attrs:{label:"数据"}},[e._v("数据")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"存储目录"}},[a("el-input",{attrs:{size:"small"},model:{value:e.logFormDialog.storageDirectory,callback:function(t){e.$set(e.logFormDialog,"storageDirectory",t)},expression:"logFormDialog.storageDirectory"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"执行地址"}},[a("el-input",{attrs:{size:"small"},model:{value:e.logFormDialog.executorAddress,callback:function(t){e.$set(e.logFormDialog,"executorAddress",t)},expression:"logFormDialog.executorAddress"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"执行耗时"}},[a("el-input",{attrs:{size:"small"},model:{value:e.logFormDialog.elapsedTime,callback:function(t){e.$set(e.logFormDialog,"elapsedTime",t)},expression:"logFormDialog.elapsedTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"应触发时间"}},[a("el-input",{attrs:{size:"small"},model:{value:e.logFormDialog.triggerTime,callback:function(t){e.$set(e.logFormDialog,"triggerTime",t)},expression:"logFormDialog.triggerTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"实际触发时间"}},[a("el-input",{attrs:{size:"small"},model:{value:e.logFormDialog.handleTime,callback:function(t){e.$set(e.logFormDialog,"handleTime",t)},expression:"logFormDialog.handleTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"执行过程"}},[a("el-input",{attrs:{size:"small",type:"textarea"},model:{value:e.logFormDialog.handleMsg,callback:function(t){e.$set(e.logFormDialog,"handleMsg",t)},expression:"logFormDialog.handleMsg"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-scrollbar",{attrs:{"wrap-class":"scrollbar-wrapper"}},[a("el-tree",{ref:"eltree",attrs:{"node-key":"nodeKey",data:e.treedata,props:e.defaultProps}})],1)],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.logDetailDialog=!1}}},[e._v("取 消")])],1)],1):e._e()],1)},l=[],r=(a("28a5"),a("ac6a"),a("4b67")),i=a("ed08"),n=a("9600"),s=a("70bc"),c={components:{handleExportD:s["default"]},data:function(){return{handleExportObj:{},activeName:"first",loading:!0,ipList:[],queryParams:{pageNum:1,pageSize:10},tableData:[],total:0,dialogTitle:"",handleDialog:!1,handleObj:{},logDetailDialog:!1,syncDescList:[],currentRow:[],loadingHis:!1,rowlogForm:{pageNum:1,pageSize:10,taskName:"",databaseId:""},dateRange:[],logTableData:[],logDataTotal:0,tableNames:[],statusOptions:[],logFormDialog:{checked:[]},defaultProps:{children:"children",label:"name"},treedata:[]}},created:function(){var e=this;Object(n["h"])().then((function(t){e.ipList=t.data})),this.getDicts("job_handle_status").then((function(t){e.statusOptions=t.data})),this.getMetaBackupList()},methods:{handleExport:function(){var e=this;Object(n["f"])(this.queryParams).then((function(t){e.downloadfileCommon(t)}))},handleFileExport:function(e){var t=this;Object(n["c"])(e).then((function(e){t.downloadfileCommon(e)}))},handleLogExport:function(e){var t=this;Object(n["g"])(this.rowlogForm).then((function(e){t.downloadfileCommon(e)}))},table_index:function(e){return(this.queryParams.pageNum-1)*this.queryParams.pageSize+e+1},table_index_log:function(e){return(this.rowlogForm.pageNum-1)*this.rowlogForm.pageSize+e+1},handleQuery:function(){this.queryParams.pageNum=1,this.getMetaBackupList()},queryListLog:function(){this.rowlogForm.pageNum=1,this.getListLog()},getMetaBackupList:function(){var e=this;this.loading=!0,Object(n["n"])(this.queryParams).then((function(t){e.tableData=t.data.pageData,e.total=t.data.totalCount,e.loading=!1}))},handleAdd:function(e){this.handleObj={},this.dialogTitle="添加",this.handleDialog=!0},handleTask:function(e,t){var a=this;this.$confirm("是否确认"+t+e.taskName+"?","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return"启动"==t?Object(n["o"])(e.id):"停止"==t?Object(n["p"])(e.id):"立即执行"==t?Object(n["e"])(e.id):void 0})).then((function(){a.getMetaBackupList(),a.msgSuccess(t+"成功")})).catch((function(){}))},deleteShow:function(){var e=this;if(this.currentRow.length>0){var t=[],a=[];this.currentRow.forEach((function(e){t.push(e.taskName),a.push(e.id)})),this.$confirm('是否确认删除"'+t.join(",")+'"?',"温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(n["m"])(a.join(","))})).then((function(){e.getMetaBackupList(),e.msgSuccess("删除成功")})).catch((function(){}))}},resetQuery:function(){this.queryParams={pageNum:1,pageSize:10,databaseId:"",taskName:"",triggerStatus:""},this.getMetaBackupList()},statusFormat:function(e,t){return this.selectDictLabel(this.statusOptions,e.handleCode)},showEditDialog:function(e){this.dialogTitle="编辑",this.handleObj=e,this.handleDialog=!0},viewDaily:function(e){this.activeName="second",this.rowlogForm.taskName=e.taskName,this.getListLog()},handleTaskSelectionChange:function(e){this.currentRow=e},handleHistorySelectionChange:function(e){this.currentRow=e},cancelHandle:function(e){this.handleObj={},this.currentRow=[],this.handleDialog=!1,this.handleQuery()},getListLog:function(){var e=this;this.loading=!0,console.log(this.rowlogForm),Object(n["k"])(this.addDateRange(this.rowlogForm,this.dateRange)).then((function(t){e.logTableData=t.data.pageData,e.logDataTotal=t.data.totalCount,e.loading=!1}))},showDetailDialog:function(e){var t=this;Object(n["l"])(e.id).then((function(e){t.logFormDialog=e.data,t.logDetailDialog=!0,t.logFormDialog.checked=[];var a=t.logFormDialog.isStructure.split(",");a.forEach((function(e){"0"==e&&t.logFormDialog.checked.push("结构"),"1"==e&&t.logFormDialog.checked.push("数据")})),t.logFormDialog.triggerTime=Object(i["c"])(t.logFormDialog.triggerTime),t.logFormDialog.handleTime=Object(i["c"])(t.logFormDialog.handleTime);var o=JSON.parse(e.data.backContent);t.treedata=Object(r["h"])(o,"")}))},download:function(e){this.handleExportObj={},this.handleExportObj.path=e.storageDirectory},deleteLog:function(e){var t=this;this.$confirm('是否确认删除"'+e.taskName+'"?',"温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(n["b"])(e.id)})).then((function(){t.handleClick(),t.msgSuccess("删除成功")})).catch((function(){}))},handleClick:function(){"first"==this.activeName?this.resetQuery():(this.rowlogForm={pageNum:1,pageSize:10,taskName:"",databaseId:""},this.queryListLog())}}},u=c,m=(a("2c2d"),a("2877")),d=Object(m["a"])(u,o,l,!1,null,null,null);t["default"]=d.exports},ec01:function(e,t,a){}}]);