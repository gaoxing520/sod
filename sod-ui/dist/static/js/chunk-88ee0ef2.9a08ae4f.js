(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-88ee0ef2","chunk-586108b5","chunk-cb29ec56"],{"0e4d":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tabs",{staticClass:"handleMaterialDialog",on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"first"}},[a("el-form",{staticClass:"demo-form-inline",attrs:{model:e.formBaseInfo,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"用户名"}},[a("el-input",{attrs:{readonly:""},model:{value:e.formBaseInfo.USERREALNAME,callback:function(t){e.$set(e.formBaseInfo,"USERREALNAME",t)},expression:"formBaseInfo.USERREALNAME"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"机构"}},[a("el-input",{attrs:{readonly:""},model:{value:e.formBaseInfo.DEPARTMENT,callback:function(t){e.$set(e.formBaseInfo,"DEPARTMENT",t)},expression:"formBaseInfo.DEPARTMENT"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系方式"}},[a("el-input",{attrs:{readonly:""},model:{value:e.formBaseInfo.USERPHONE,callback:function(t){e.$set(e.formBaseInfo,"USERPHONE",t)},expression:"formBaseInfo.USERPHONE"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"申请时间"}},[a("el-input",{attrs:{readonly:""},model:{value:e.formBaseInfo.CREATE_TIME,callback:function(t){e.$set(e.formBaseInfo,"CREATE_TIME",t)},expression:"formBaseInfo.CREATE_TIME"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"数据库账户名"}},[a("el-input",{attrs:{readonly:""},model:{value:e.formBaseInfo.DATABASE_UP_ID,callback:function(t){e.$set(e.formBaseInfo,"DATABASE_UP_ID",t)},expression:"formBaseInfo.DATABASE_UP_ID"}})],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:22}},[a("el-form-item",{attrs:{label:"数据库账户密码"}},[a("el-input",{attrs:{readonly:"",type:e.passwordType,name:"password"},on:{blur:function(t){e.capsTooltip=!1}},model:{value:e.formBaseInfo.DATABASE_UP_PASSWORD,callback:function(t){e.$set(e.formBaseInfo,"DATABASE_UP_PASSWORD",t)},expression:"formBaseInfo.DATABASE_UP_PASSWORD"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"unitFormItem"},[a("i",{class:"password"===e.passwordType?"eye isEye":"el-icon-view isEye",on:{click:e.showPwd}})])],1)],1)],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"数据读写权限",name:"second"}},[a("el-alert",{attrs:{title:"申请状态：已申请"+e.tableData.length+"种资料,涉及"+e.tableData.length+"张表的读写权限， 审核通过"+e.AUTHORIZE_NUM+"张表, 审核不通过"+e.AUTHORIZEF_NUM+"张表",type:"success",closable:!1}}),e._v(" "),a("el-form",{ref:"queryForm",attrs:{model:e.queryParams,inline:!0}},[a("el-form-item",{attrs:{label:"关键字查询"}},[a("el-select",{attrs:{size:"small"},on:{change:e.changeSearch},model:{value:e.queryParams.searchSelect,callback:function(t){e.$set(e.queryParams,"searchSelect",t)},expression:"queryParams.searchSelect"}},[a("el-option",{attrs:{label:"资料分类",value:"typeName"}}),e._v(" "),a("el-option",{attrs:{label:"资料名称",value:"className"}}),e._v(" "),a("el-option",{attrs:{label:"表名称",value:"tableName"}}),e._v(" "),a("el-option",{attrs:{label:"数据库",value:"databaseName"}}),e._v(" "),a("el-option",{attrs:{label:"申请状态",value:"applyAuthority"}}),e._v(" "),a("el-option",{attrs:{label:"审核状态",value:"authorize"}}),e._v(" "),a("el-option",{attrs:{label:"专题名",value:"specialDatabaseName"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-input",{attrs:{size:"small",type:"text"},model:{value:e.queryParams.searchInput,callback:function(t){e.$set(e.queryParams,"searchInput",t)},expression:"queryParams.searchInput"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.handleQuery}},[e._v("查询")])],1)],1),e._v(" "),a("el-row",{staticClass:"mb8",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-thumb",size:"mini"},on:{click:e.handlePower}},[e._v("授权")]),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-close",size:"mini"},on:{click:e.handleRefused}},[e._v("拒接")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.tableData,"row-key":"id"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"TYPE_NAME",label:"资料分类","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"CLASS_NAME",label:"资料名称","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"TABLE_NAME",label:"表名称","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"DATABASE_NAME",label:"数据库","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"SPECIAL_DATABASE_NAME",label:"专题名","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"IS_ACCESS",label:"权限",width:"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return["0"==t.row.IS_ACCESS?a("span",[e._v("受限")]):a("span",[e._v("公开")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"APPLY_AUTHORITY",label:"申请状态",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return["1"==t.row.APPLY_AUTHORITY?a("span",[e._v("读申请")]):a("span",[e._v("读写申请")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"AUTHORIZE",label:"审核状态",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return["2"==t.row.AUTHORIZE?a("span",[a("i",{staticClass:"el-icon-circle-close",staticStyle:{color:"#F56C6C"}}),e._v("拒绝\n          ")]):"1"==t.row.AUTHORIZE?a("span",[a("i",{staticClass:"el-icon-circle-check",staticStyle:{color:"#67C23A"}}),e._v("通过\n          ")]):a("span",[a("i",{staticClass:"el-icon-s-finance",staticStyle:{color:"#E6A23C"}}),e._v("待审核\n          ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"CAUSE",label:"拒绝原因",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.CAUSE?a("el-popover",{attrs:{placement:"top",effect:"dark",trigger:"hover",width:"200","popper-class":"darkPopover"}},[a("p",[e._v(e._s(t.row.CAUSE))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("el-button",{staticClass:"tagpointer",attrs:{type:"primary",size:"mini",plain:""}},[e._v("查看")])],1)]):e._e()]}}])})],1)],1)],1)},r=[],o=(a("ac6a"),a("96cf"),a("3b8d")),n=a("e254"),s={name:"handleMaterialDialog",props:{handleObj:{type:Object}},data:function(){return{passwordType:"password",activeName:"first",formBaseInfo:{},queryParams:{},searchKey:"",loading:!1,tableData:[],total:0,AUTHORIZE_NUM:0,AUTHORIZEF_NUM:0,multipleSelection:[]}},created:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.queryParams.id=this.handleObj.id,!this.handleObj.id){e.next=4;break}return e.next=4,Object(n["a"])({id:this.handleObj.id}).then((function(e){200==e.code?t.formBaseInfo=e.data:t.msgError(e.msg)}));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{showPwd:function(){"password"===this.passwordType?this.passwordType="":this.passwordType="password"},handleClick:function(){"second"==this.activeName&&this.handleQuery()},handleSelectionChange:function(e){this.multipleSelection=e},changeSearch:function(e){this.searchKey=e},getList:function(e){var t=this;console.log(e),Object(n["c"])(e).then((function(e){200==e.code?(t.tableData=e.data,t.AUTHORIZE_NUM=0,t.AUTHORIZEF_NUM0=0,t.tableData.forEach((function(e){1==e.AUTHORIZE?t.AUTHORIZE_NUM++:2==e.AUTHORIZE&&t.AUTHORIZEF_NUM++}))):t.msgError(e.msg)}))},handleQuery:function(){var e=this.queryParams.searchInput;"applyAuthority"!=this.searchKey&&"authorize"!=this.searchKey||(e="读申请"==e||"通过"==e?"1":"读写申请"==e||"拒绝"==e?"2":"");var t={};t.applyId=this.queryParams.id,t[this.queryParams.searchSelect]=e,this.getList(t)},handlePower:function(){0!=this.multipleSelection.lenght?(console.log(this.multipleSelection),this.powerMethods()):this.msgError("请选择一条数据")},handleRefused:function(){var e=this;0!=this.multipleSelection.lenght?this.$prompt("请输入拒绝原因","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"拒绝原因不能为空"}).then((function(t){var a=t.value;e.powerMethods(a)})).catch((function(){})):this.msgError("请选择一条数据")},powerMethods:function(e){var t=this,a={userId:"admin",dataAuthorityRecordList:[]};this.multipleSelection.forEach((function(t){var l={};l.id=t.ID,l.applyId=t.APPLY_ID,l.databaseId=t.DATABASE_ID,l.applyAuthority=t.APPLY_AUTHORITY,l.authorize=e?2:1,l.dataClassId=t.DATA_CLASS_ID,l.cause=e,a.dataAuthorityRecordList.push(l)})),console.log(a),Object(n["f"])(JSON.parse(JSON.stringify(a))).then((function(a){200==a.code?(e?t.msgSuccess("拒绝成功"):t.msgSuccess("授权成功"),t.handleQuery()):t.msgError(a.msg)}))}}},i=s,c=(a("9fa9"),a("2877")),u=Object(c["a"])(i,l,r,!1,null,null,null);t["default"]=u.exports},"740e":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{ref:"queryForm",staticClass:"searchBox",attrs:{model:e.queryParams,inline:!0}},[a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{staticStyle:{width:"240px"},attrs:{placeholder:"状态",clearable:"",size:"small"},model:{value:e.queryParams.auditStatus,callback:function(t){e.$set(e.queryParams,"auditStatus",t)},expression:"queryParams.auditStatus"}},[a("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),e._l(e.examineStatus,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"申请人"}},[a("el-input",{attrs:{size:"small",placeholder:"申请人"},model:{value:e.queryParams.userName,callback:function(t){e.$set(e.queryParams,"userName",t)},expression:"queryParams.userName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"申请时间"}},[a("el-date-picker",{attrs:{size:"small",type:"datetimerange","range-separator":"~","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}},[e._v(">")])],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.handleQuery}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{size:"small",icon:"el-icon-refresh-right"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1),e._v(" "),a("el-row",{staticClass:"handleTableBox",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["authorityAudit:materialPower:add"],expression:"['authorityAudit:materialPower:add']"}],attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:e.handleAdd}},[e._v("权限配置")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.tableData,"row-key":"id"},on:{"sort-change":e.sortChange}},[a("el-table-column",{attrs:{type:"index",width:"50",index:e.table_index}}),e._v(" "),a("el-table-column",{attrs:{prop:"userName",label:"用户名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"department",label:"机构"}}),e._v(" "),a("el-table-column",{attrs:{prop:"telephone",label:"联系方式"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"申请时间",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.parseTime(t.row.createTime)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"db_name",label:"资料个数",formatter:function(e){return e.dataAuthorityRecordList.length}}}),e._v(" "),a("el-table-column",{attrs:{prop:"examine_status",label:"状态",formatter:e.statusShow}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-view"},on:{click:function(a){return e.viewCell(t.row)}}},[e._v("查看")])]}}])})],1),e._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}}),e._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"数据授权查看",visible:e.handleDialog,width:"90%","max-width":"1100px",top:"5vh"},on:{"update:visible":function(t){e.handleDialog=t}}},[e.handleDialog?a("handleMaterial",{ref:"myHandleServer",attrs:{handleObj:e.handleObj}}):e._e()],1),e._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"权限配置",visible:e.handlepowerDialog,width:"650px"},on:{"update:visible":function(t){e.handlepowerDialog=t}}},[e.handlepowerDialog?a("handlePower",{ref:"myHandleServer",on:{cancelHandle:e.cancelHandle}}):e._e()],1)],1)},r=[],o=a("e254"),n=a("0e4d"),s=a("e10d"),i={components:{handleMaterial:n["default"],handlePower:s["default"]},data:function(){return{loading:!0,queryParams:{pageNum:1,pageSize:10,auditStatus:"",userName:"",params:{orderBy:{createTime:"desc"}}},dateRange:[],examineStatus:[{value:"01",label:"待审核"},{value:"02",label:"已审核"}],total:0,tableData:[],dialogTitle:"",handleDialog:!1,handlepowerDialog:!1}},created:function(){this.getList()},methods:{sortChange:function(e,t,a){var l={};"ascending"==e.order?l.createTime="asc":l.createTime="desc",this.queryParams.params.orderBy=l,this.handleQuery()},table_index:function(e){return(this.queryParams.pageNum-1)*this.queryParams.pageSize+e+1},handleQuery:function(){this.queryParams.pageNum=1,this.getList()},getList:function(){var e=this;this.loading=!0,Object(o["d"])(this.addDateRange(this.queryParams,this.dateRange)).then((function(t){e.tableData=t.data.pageData,e.total=t.data.totalCount,e.loading=!1}))},resetQuery:function(){this.dateRange=[],this.queryParams={pageNum:1,pageSize:10,auditStatus:"",userName:""},this.handleQuery()},handleAdd:function(){this.handleObj={},this.handlepowerDialog=!0},downloadTable:function(){},viewReason:function(e){this.$alert(e.failure_reason,"拒绝原因",{confirmButtonText:"确定"})},viewCell:function(e){this.handleObj=e,this.handleDialog=!0},deleteCell:function(e){},analysisCell:function(e){},handleDialogClose:function(){this.handleDialog=!1,this.handleObj={}},statusShow:function(e){var t="02"==e.auditStatus?"已审核":"待审核";return t},cancelHandle:function(){this.handleQuery(),this.handlepowerDialog=!1,this.handleDialog=!1}}},c=i,u=a("2877"),m=Object(u["a"])(c,l,r,!1,null,null,null);t["default"]=m.exports},"7b00":function(e,t,a){},"9fa9":function(e,t,a){"use strict";var l=a("7b00"),r=a.n(l);r.a},e10d:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"powerDialog"},[a("el-form",{ref:"ruleForm",attrs:{rules:e.rules,model:e.msgFormDialog,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"配置名称",prop:"name"}},[a("el-input",{attrs:{size:"medium",readonly:""},model:{value:e.msgFormDialog.name,callback:function(t){e.$set(e.msgFormDialog,"name",t)},expression:"msgFormDialog.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"权限",prop:"roleKey"}},[a("el-input",{attrs:{size:"medium",readonly:""},model:{value:e.msgFormDialog.roleKey,callback:function(t){e.$set(e.msgFormDialog,"roleKey",t)},expression:"msgFormDialog.roleKey"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"默认通过"}},[a("el-radio-group",{model:{value:e.msgFormDialog.value,callback:function(t){e.$set(e.msgFormDialog,"value",t)},expression:"msgFormDialog.value"}},[a("el-radio",{attrs:{label:"1"}},[e._v("通过")]),e._v(" "),a("el-radio",{attrs:{label:"0"}},[e._v("不通过")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"描述",prop:"description"}},[a("el-input",{attrs:{type:"textarea",size:"medium"},model:{value:e.msgFormDialog.description,callback:function(t){e.$set(e.msgFormDialog,"description",t)},expression:"msgFormDialog.description"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.trueDialog("ruleForm")}}},[e._v("确 定")]),e._v(" "),a("el-button",{on:{click:function(t){return e.cancelDialog("ruleForm")}}},[e._v("取 消")])],1)],1)},r=[],o=a("e254"),n={name:"powerDialog",data:function(){return{msgFormDialog:{name:"是否默认通过所有申请资料的读权限",roleKey:"读权限",value:"0",description:""},rules:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"}],description:[{required:!0,message:"请输入描述",trigger:"blur"}]}}},created:function(){var e=this;Object(o["b"])().then((function(t){t.data&&t.data.length>0&&(e.msgFormDialog=t.data[0]),e.msgFormDialog.roleKey="读权限"}))},methods:{trueDialog:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;Object(o["e"])(t.msgFormDialog).then((function(e){200==e.code?(t.$message({type:"success",message:"操作成功"}),t.$emit("cancelHandle")):t.$message({type:"danger",message:"操作失败"})}))}))},cancelDialog:function(e){this.$emit("cancelHandle")}}},s=n,i=a("2877"),c=Object(i["a"])(s,l,r,!1,null,null,null);t["default"]=c.exports},e254:function(e,t,a){"use strict";a.d(t,"d",(function(){return o})),a.d(t,"a",(function(){return n})),a.d(t,"c",(function(){return s})),a.d(t,"f",(function(){return i})),a.d(t,"b",(function(){return c})),a.d(t,"e",(function(){return u}));var l=a("b775"),r="http://10.40.79.18:8005";function o(e){return Object(l["a"])({url:r+"/dm/dataAuthorityApply/list",method:"get",params:e})}function n(e){return Object(l["a"])({url:r+"/dm/dataAuthorityApply/getApplyInfoById",method:"get",params:e})}function s(e){return Object(l["a"])({url:r+"/dm/dataAuthorityApply/getRecordByApplyId",method:"get",params:e})}function i(e){return Object(l["a"])({url:r+"/dm/dataAuthorityApply/updateRecordCheck",method:"PUT",data:e})}function c(e){return Object(l["a"])({url:r+"/dm/dataAuthorityApply/getReadAuthority",method:"get",params:e})}function u(e){return Object(l["a"])({url:r+"/dm/dataAuthorityApply/updateReadAuthority",method:"post",data:e})}}}]);