(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a4be7792"],{"40d5":function(e,t,a){"use strict";var l=a("b868"),r=a.n(l);r.a},b868:function(e,t,a){},f75a:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dataRegister"},[a("el-form",{ref:"registerForm",attrs:{"label-width":e.labelWidth,model:e.registerForm,rules:e.rule}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"表名",prop:"tableName"}},[a("el-input",{attrs:{size:"small",plcaeholder:"请输入表名"},model:{value:e.registerForm.tableName,callback:function(t){e.$set(e.registerForm,"tableName",t)},expression:"registerForm.tableName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"数据用途",prop:"logicId"}},[a("el-select",{staticClass:"size-full",attrs:{size:"small"},on:{change:e.logicIdChange},model:{value:e.registerForm.logicId,callback:function(t){e.$set(e.registerForm,"logicId",t)},expression:"registerForm.logicId"}},e._l(e.logicDBArr,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"数据库",prop:"physicId"}},[a("el-select",{staticClass:"size-full",attrs:{size:"small"},on:{change:e.schemaIdChange},model:{value:e.registerForm.physicId,callback:function(t){e.$set(e.registerForm,"physicId",t)},expression:"registerForm.physicId"}},e._l(e.PhysicDBByLogicArr,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"专题名",prop:"schemaId"}},[a("el-select",{staticClass:"size-full",attrs:{size:"small"},model:{value:e.registerForm.schemaId,callback:function(t){e.$set(e.registerForm,"schemaId",t)},expression:"registerForm.schemaId"}},e._l(e.schemaInfoArr,(function(e,t){return a("el-option",{key:t,attrs:{label:e.dbname,value:e.id}})})),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"数据频次"}},[a("el-select",{staticClass:"size-full",attrs:{size:"small"},model:{value:e.registerForm.dataFreq,callback:function(t){e.$set(e.registerForm,"dataFreq",t)},expression:"registerForm.dataFreq"}},[a("el-option",{attrs:{value:"不定"}},[e._v("不定")]),e._v(" "),a("el-option",{attrs:{value:"连续"}},[e._v("连续")]),e._v(" "),a("el-option",{attrs:{value:"1分钟"}},[e._v("1分钟")]),e._v(" "),a("el-option",{attrs:{value:"5分钟"}},[e._v("5分钟")]),e._v(" "),a("el-option",{attrs:{value:"6分钟"}},[e._v("6分钟")]),e._v(" "),a("el-option",{attrs:{value:"10分钟"}},[e._v("10分钟")]),e._v(" "),a("el-option",{attrs:{value:"15分钟"}},[e._v("15分钟")]),e._v(" "),a("el-option",{attrs:{value:"30分钟"}},[e._v("30分钟")]),e._v(" "),a("el-option",{attrs:{value:"每小时"}},[e._v("每小时")]),e._v(" "),a("el-option",{attrs:{value:"3小时"}},[e._v("3小时")]),e._v(" "),a("el-option",{attrs:{value:"6小时"}},[e._v("6小时")]),e._v(" "),a("el-option",{attrs:{value:"8小时"}},[e._v("8小时")]),e._v(" "),a("el-option",{attrs:{value:"12小时"}},[e._v("12小时")]),e._v(" "),a("el-option",{attrs:{value:"每天"}},[e._v("每天")]),e._v(" "),a("el-option",{attrs:{value:"每候"}},[e._v("每候")]),e._v(" "),a("el-option",{attrs:{value:"每周"}},[e._v("每周")]),e._v(" "),a("el-option",{attrs:{value:"每8日"}},[e._v("每8日")]),e._v(" "),a("el-option",{attrs:{value:"每旬"}},[e._v("每旬")]),e._v(" "),a("el-option",{attrs:{value:"每两周"}},[e._v("每两周")]),e._v(" "),a("el-option",{attrs:{value:"每16日"}},[e._v("每16日")]),e._v(" "),a("el-option",{attrs:{value:"每月"}},[e._v("每月")]),e._v(" "),a("el-option",{attrs:{value:"3个月"}},[e._v("3个月")]),e._v(" "),a("el-option",{attrs:{value:"6个月"}},[e._v("6个月")]),e._v(" "),a("el-option",{attrs:{value:"每年"}},[e._v("每年")]),e._v(" "),a("el-option",{attrs:{value:"每10年"}},[e._v("每10年")]),e._v(" "),a("el-option",{attrs:{value:"逐轨"}},[e._v("逐轨")])],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"数据权限"}},[a("el-select",{staticClass:"size-full",attrs:{size:"small"},model:{value:e.registerForm.published,callback:function(t){e.$set(e.registerForm,"published",t)},expression:"registerForm.published"}},[a("el-option",{attrs:{label:"公开",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"限制",value:"2"}})],1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"其他说明"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入相关说明，例如数据名称等信息"},model:{value:e.registerForm.memo,callback:function(t){e.$set(e.registerForm,"memo",t)},expression:"registerForm.memo"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"属性资料"}},[a("el-radio-group",{on:{change:e.dataPropChange},model:{value:e.registerForm.dataProp,callback:function(t){e.$set(e.registerForm,"dataProp",t)},expression:"registerForm.dataProp"}},["STDB"===this.registerForm.physicId?a("el-radio",{attrs:{label:"站点要素写入",value:"1"}}):e._e(),e._v(" "),"FIDB"===this.registerForm.physicId?a("el-radio",{attrs:{label:"产品文件写入",value:"2"}}):e._e(),e._v(" "),"RADB"===this.registerForm.physicId?a("el-radio",{attrs:{label:"数据块写入",value:"3"}}):e._e()],1)],1)],1)],1),e._v(" "),a("el-row",["RADB"===this.registerForm.physicId?a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"数据显示"}},[a("el-radio-group",{on:{change:e.datashowChange},model:{value:e.datashow,callback:function(t){e.datashow=t},expression:"datashow"}},[a("el-radio",{attrs:{label:"文件块",value:"1"}}),e._v(" "),a("el-radio",{attrs:{label:"站级文件块",value:"2"}}),e._v(" "),a("el-radio",{attrs:{label:"格点数据块",value:"3"}})],1)],1)],1):e._e()],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"常用字段"}},[a("el-input",{attrs:{size:"small",disabled:!0,placeholder:"请选择基本字段或自定义字段表中数据"},model:{value:e.registerForm.freuseField,callback:function(t){e.$set(e.registerForm,"freuseField",t)},expression:"registerForm.freuseField"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"基本字段"}})],1)],1),e._v(" "),a("el-table",{attrs:{data:e.tableData,border:"",stripe:""},on:{"selection-change":e.tableDataChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:"字段名称",prop:"c_element_code"}}),e._v(" "),a("el-table-column",{attrs:{label:"中文名",prop:"c_element_namech"}}),e._v(" "),a("el-table-column",{attrs:{label:"字段类型",prop:"c_datatype"}}),e._v(" "),a("el-table-column",{attrs:{label:"单位",prop:"c_element_unit"}}),e._v(" "),a("el-table-column",{attrs:{label:"字段长度",prop:"fieldLength"}}),e._v(" "),a("el-table-column",{attrs:{label:"字段精度",prop:"filedPer"}}),e._v(" "),a("el-table-column",{attrs:{label:"字段排序",prop:"orders"}}),e._v(" "),a("el-table-column",{attrs:{formatter:e.formatterQc,label:"主键",prop:"c_isqc"}}),e._v(" "),a("el-table-column",{attrs:{formatter:e.formatterNo,label:"是否可空",prop:"c_no"}})],1),e._v(" "),a("el-row",{staticClass:"rowSelDefined"},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"自定义字段"}},[a("div",{staticClass:"selDefined"},[a("el-button",{staticClass:"el-icon-plus",attrs:{size:"small",type:"primary"},on:{click:e.addTableData}},[e._v("新增")]),e._v(" "),a("el-upload",{attrs:{"auto-upload":!1,"file-list":e.excelFileList,"on-change":e.excelRemoveFileList,action:"sdasd"}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("Excle模板文件")])],1),e._v(" "),a("el-button",{attrs:{icon:"el-icon-download",size:"small"},on:{click:e.downFile}},[e._v("模板下载")])],1)])],1)],1),e._v(" "),a("el-table",{attrs:{data:e.definedTableData,border:"",stripe:""},on:{"cell-click":e.definedTableEdit,"selection-change":e.definedTableDataChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:"字段名称",prop:"c_element_code"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.c_element_code.edit?a("el-input",{ref:"c_element_code",staticStyle:{width:"100%"},on:{blur:function(a){return e.fileNameBlur(t.row)}},model:{value:t.row.c_element_code.value,callback:function(a){e.$set(t.row.c_element_code,"value",a)},expression:"scope.row.c_element_code.value"}}):a("span",{staticClass:"editStyle"},[e._v(e._s(t.row.c_element_code.value))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"中文名",prop:"c_element_namech"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.c_element_namech.edit?a("el-input",{ref:"c_element_namech",staticStyle:{width:"100%"},attrs:{size:"small"},on:{blur:function(e){t.row.c_element_namech.edit=!1}},model:{value:t.row.c_element_namech.value,callback:function(a){e.$set(t.row.c_element_namech,"value",a)},expression:"scope.row.c_element_namech.value"}}):a("span",{staticClass:"editStyle"},[e._v(e._s(t.row.c_element_namech.value))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"字段类型",prop:"c_datatype"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.c_datatype.edit?a("el-select",{ref:"c_datatype",staticStyle:{width:"100%"},attrs:{size:"small"},on:{change:function(e){t.row.c_datatype.edit=!1}},model:{value:t.row.c_datatype.value,callback:function(a){e.$set(t.row.c_datatype,"value",a)},expression:"scope.row.c_datatype.value"}},e._l(e.fieldTypeArr,(function(e){return a("el-option",{key:e.fieldtype,attrs:{label:e.fieldtype,value:e.fieldtype}})})),1):a("span",{staticClass:"editStyle"},[e._v(e._s(t.row.c_datatype.value))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"单位",prop:"c_element_unit"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.c_element_unit.edit?a("el-input",{ref:"c_element_unit",staticStyle:{width:"100%"},attrs:{size:"small"},on:{blur:function(e){t.row.c_element_unit.edit=!1}},model:{value:t.row.c_element_unit.value,callback:function(a){e.$set(t.row.c_element_unit,"value",a)},expression:"scope.row.c_element_unit.value"}}):a("span",{staticClass:"editStyle"},[e._v(e._s(t.row.c_element_unit.value))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"字段长度",prop:"fieldLength"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.fieldLength.edit?a("el-input",{ref:"fieldLength",staticStyle:{width:"100%"},attrs:{size:"small"},on:{blur:function(e){t.row.fieldLength.edit=!1}},model:{value:t.row.fieldLength.value,callback:function(a){e.$set(t.row.fieldLength,"value",a)},expression:"scope.row.fieldLength.value"}}):a("span",{staticClass:"editStyle"},[e._v(e._s(t.row.fieldLength.value))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"字段精度",prop:"filedPer"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.filedPer.edit?a("el-input",{ref:"filedPer",staticStyle:{width:"100%"},attrs:{size:"small"},on:{blur:function(e){t.row.filedPer.edit=!1}},model:{value:t.row.filedPer.value,callback:function(a){e.$set(t.row.filedPer,"value",a)},expression:"scope.row.filedPer.value"}}):a("span",{staticClass:"editStyle"},[e._v(e._s(t.row.filedPer.value))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"字段排序",prop:"orders"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.orders.edit?a("el-input",{ref:"orders",staticStyle:{width:"100%"},attrs:{size:"small"},on:{blur:function(e){t.row.orders.edit=!1}},model:{value:t.row.orders.value,callback:function(a){e.$set(t.row.orders,"value",a)},expression:"scope.row.orders.value"}}):a("span",{staticClass:"editStyle"},[e._v(e._s(t.row.orders.value))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"主键",prop:"c_isqc"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.c_isqc.edit?a("el-select",{ref:"c_isqc",staticStyle:{width:"100%"},attrs:{size:"small"},on:{change:function(e){t.row.c_isqc.edit=!1}},model:{value:t.row.c_isqc.value,callback:function(a){e.$set(t.row.c_isqc,"value",a)},expression:"scope.row.c_isqc.value"}},[a("el-option",{attrs:{label:"是",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"否",value:"0"}})],1):a("span",{staticClass:"editStyle"},[e._v(e._s(1==t.row.c_isqc.value?"是":"否"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"是否可空",prop:"c_no"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.c_no.edit?a("el-select",{ref:"c_no",staticStyle:{width:"100%"},attrs:{size:"small"},on:{change:function(e){t.row.c_no.edit=!1}},model:{value:t.row.c_no.value,callback:function(a){e.$set(t.row.c_no,"value",a)},expression:"scope.row.c_no.value"}},[a("el-option",{attrs:{label:"是",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"否",value:"0"}})],1):a("span",{staticClass:"editStyle"},[e._v(e._s(1==t.row.c_no.value?"是":"否"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("i",{staticClass:"el-icon-circle-plus",staticStyle:{color:"#409EFF","font-size":"18px",cursor:"pointer"},on:{click:e.addTableData}}),e._v(" "),a("i",{staticClass:"el-icon-remove",staticStyle:{color:"#F56C6C","font-size":"18px",cursor:"pointer"},on:{click:function(a){return e.deleteTableData(t)}}})]}}])})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.makeSure(!0)}}},[e._v("立即提交")]),e._v(" "),a("el-button",{on:{click:function(t){return e.makeSure(!1)}}},[e._v("关闭")])],1)],1)},r=[],n=(a("96cf"),a("3b8d")),o=(a("ac6a"),a("7f7f"),{name:"dataRegister",data:function(){return{labelWidth:"90px",registerForm:{dDataId:"Z.9999.9999",dataOrigin:"MUSIC接口注册",tableName:"",logicId:"",dataFreq:"不定",published:"1",memo:"",freuseField:"",userId:"",applyId:"",dataProp:"",physicId:"",schemaId:""},logicDBArr:[],PhysicDBByLogicArr:[],schemaInfoArr:[],datashow:"",freuseFieldArr:[],tableData:[],tableDataMul:[],definedTableDataMul:[],stateData:[{c_element_code:"D_DATETIME",c_element_namech:"资料时间",c_datatype:"bigint",c_element_unit:null,fieldLength:"14",filedPer:"0",orders:"0",c_isqc:"1",c_no:"0"}],profileData:[{c_element_code:"D_DATETIME",c_element_namech:"资料时间",c_datatype:"bigint",c_element_unit:null,fieldLength:"14",filedPer:"0",orders:"0",c_isqc:"1",c_no:"0"},{c_element_code:"V_FILE_NAME",c_element_namech:"文件名",c_datatype:"varchar",c_element_unit:null,fieldLength:"150",filedPer:"0",orders:"0",c_isqc:"1",c_no:"0"},{c_element_code:"V_FILE_FORMAT",c_element_namech:"文件格式",c_datatype:"varchar",c_element_unit:null,fieldLength:"5",filedPer:"0",orders:"0",c_isqc:"1",c_no:"0"},{c_element_code:"D_FILE_SIZE",c_element_namech:"文件大小",c_datatype:"number",c_element_unit:"byte",fieldLength:"12",filedPer:"0",orders:"0",c_isqc:"1",c_no:"0"}],blockData1:[{c_element_code:"D_PRODCODE",c_element_namech:"资料代码",c_datatype:"text",c_element_unit:null,fieldLength:"150",filedPer:"0",orders:"0",c_isqc:"1",c_no:"0"},{c_element_code:"D_DATETIME",c_element_namech:"资料时间",c_datatype:"bigint",c_element_unit:null,fieldLength:"14",filedPer:"0",orders:"0",c_isqc:"1",c_no:"0"},{c_element_code:"V_FILE_NAME",c_element_namech:"文件名",c_datatype:"varchar",c_element_unit:null,fieldLength:"150",filedPer:"0",orders:"0",c_isqc:"1",c_no:"0"},{c_element_code:"D_DATASTATICS",c_element_namech:"资料数据",c_datatype:"map",c_element_unit:null,fieldLength:"150",filedPer:"0",orders:"0",c_isqc:"1",c_no:"0"},{c_element_code:"D_DATAID",c_element_namech:"四级编码",c_datatype:"varchar",c_element_unit:null,fieldLength:"50",filedPer:"0",orders:"0",c_isqc:"1",c_no:"0"}],blockData2:[{c_element_code:"D_PRODCODE",c_element_namech:"资料代码",c_datatype:"text",c_element_unit:null,fieldLength:"150",filedPer:"0",orders:"0",c_isqc:"1",c_no:"0"},{c_element_code:"D_DATETIME",c_element_namech:"资料时间",c_datatype:"bigint",c_element_unit:null,fieldLength:"14",filedPer:"0",orders:"0",c_isqc:"1",c_no:"0"},{c_element_code:"D_DATASTATICS",c_element_namech:"资料数据",c_datatype:"map",c_element_unit:null,fieldLength:"150",filedPer:"0",orders:"0",c_isqc:"1",c_no:"0"},{c_element_code:"D_DATAID",c_element_namech:"四级编码",c_datatype:"varchar",c_element_unit:null,fieldLength:"50",filedPer:"0",orders:"0",c_isqc:"1",c_no:"0"}],blockData3:[{c_element_code:"D_PRODCODE",c_element_namech:"资料代码",c_datatype:"text",c_element_unit:null,fieldLength:"150",filedPer:"0",orders:"0",c_isqc:"1",c_no:"0"},{c_element_code:"D_DATETIME",c_element_namech:"资料时间",c_datatype:"bigint",c_element_unit:null,fieldLength:"14",filedPer:"0",orders:"0",c_isqc:"1",c_no:"0"},{c_element_code:"D_DATASTATICS",c_element_namech:"资料数据",c_datatype:"map",c_element_unit:null,fieldLength:"150",filedPer:"0",orders:"0",c_isqc:"1",c_no:"0"},{c_element_code:"STARTX",c_element_namech:"西经",c_datatype:"float",c_element_unit:null,fieldLength:"150",filedPer:"0",orders:"0",c_isqc:"1",c_no:"0"},{c_element_code:"ENDX",c_element_namech:"东经",c_datatype:"float",c_element_unit:null,fieldLength:"14",filedPer:"0",orders:"0",c_isqc:"1",c_no:"0"},{c_element_code:"STARTY",c_element_namech:"南纬",c_datatype:"float",c_element_unit:null,fieldLength:"14",filedPer:"0",orders:"0",c_isqc:"1",c_no:"0"},{c_element_code:"ENDY",c_element_namech:"北纬",c_datatype:"float",c_element_unit:null,fieldLength:"14",filedPer:"0",orders:"0",c_isqc:"1",c_no:"0"},{c_element_code:"XSTEP",c_element_namech:"经向格距",c_datatype:"float",c_element_unit:null,fieldLength:"14",filedPer:"0",orders:"0",c_isqc:"1",c_no:"0"},{c_element_code:"YSTEP",c_element_namech:"纬向格距",c_datatype:"float",c_element_unit:null,fieldLength:"14",filedPer:"0",orders:"0",c_isqc:"1",c_no:"0"},{c_element_code:"XCOUNT",c_element_namech:"经向格数",c_datatype:"int",c_element_unit:null,fieldLength:"14",filedPer:"0",orders:"0",c_isqc:"1",c_no:"0"},{c_element_code:"YCOUNT",c_element_namech:"纬向格数",c_datatype:"int",c_element_unit:null,fieldLength:"50",filedPer:"0",orders:"0",c_isqc:"1",c_no:"0"},{c_element_code:"D_DATAID",c_element_namech:"四级编码",c_datatype:"varchar",c_element_unit:null,fieldLength:"50",filedPer:"0",orders:"0",c_isqc:"1",c_no:"0"}],excelFileList:[],definedTableData:[],fieldTypeArr:[],flage:!1,rule:{tableName:[{required:!0,message:"表名不能为空",trigger:"blur"}],logicId:[{required:!0,message:"数据用途不能为空",trigger:"change"}],physicId:[{required:!0,message:"数据库不能为空",trigger:"change"}],schemaId:[{required:!0,message:"专题名不能为空",trigger:"change"}]}}},mounted:function(){},methods:{getFieldTypeVal:function(){var e=this;this.axios.get(interfaceObj.getFieldType).then((function(t){var a=t.data;"0"==a.returnCode?e.fieldTypeArr=a.DS:e.$message({type:"error",message:a.returnMessage})}))},initLogicDB:function(){var e=this;this.axios.get(interfaceObj.getLogicDB).then((function(t){var a=t.data;"0"==a.returnCode?e.logicDBArr=a.DS:e.$message({type:"error",message:a.returnMessage})})).catch((function(e){console.log(e)}))},logicIdChange:function(){var e=this;""!==this.registerForm.logicId&&this.axios.get(interfaceObj.getPhysicDBByLogic,{params:{logicId:this.registerForm.logicId,userId:""}}).then((function(t){var a=t.data;if("0"==a.returnCode){e.registerForm.physicId="";var l=a.DS;e.PhysicDBByLogicArr=l.map((function(e){return e.name=e.name+"【"+e.id+"】",e}))}else e.$message({type:"error",message:a.returnMessage})})).catch((function(e){console.log(e)}))},schemaIdChange:function(){var e=this;""!==this.registerForm.physicId&&this.axios.get(interfaceObj.getSchemaInfo,{params:{physicId:this.registerForm.physicId,userId:""}}).then((function(t){var a=t.data;if("0"==a.returnCode){e.registerForm.schemaId="";var l=a.DS;e.schemaInfoArr=l.map((function(e){return e.dbname=e.dbname+"【"+e.physicid+"】",e}))}else e.$message({type:"error",message:a.returnMessage})})).catch((function(e){console.log(e)}))},dataPropChange:function(){"数据块写入"===this.registerForm.dataProp?(this.datashow="文件块",this.tableData=this.blockData1):"产品文件写入"===this.registerForm.dataProp?this.tableData=this.profileData:"站点要素写入"===this.registerForm.dataProp&&(this.tableData=this.stateData)},datashowChange:function(){"文件块"===this.datashow?this.tableData=this.blockData1:"站级文件块"===this.datashow?this.tableData=this.blockData2:"格点数据块"===this.datashow&&(this.tableData=this.blockData3)},excelRemoveFileList:function(e,t){var a,l=this;this.excelFileList=t.slice(-1);var r=new FileReader;r.onload=function(e){var t=e.target.result,r=XLSX.read(t,{type:"binary"}),n=XLSX.utils.sheet_to_json(r.Sheets[r.SheetNames[0]]).length;a=r.Sheets[r.SheetNames[0]];try{for(var o=[],i=0;i<n;i++){var s={};s.c_element_code=a["A"+(i+2)].v,s.c_element_namech=a["B"+(i+2)].v,s.c_datatype=a["C"+(i+2)].v,s.c_element_unit=a["D"+(i+2)].v,s.fieldLength=a["E"+(i+2)].v,s.filedPer=a["F"+(i+2)].v,s.orders=a["G"+(i+2)].v,"是"==a["H"+(i+2)].v?s.c_isqc=1:s.c_isqc=0,"是"==a["I"+(i+2)].v?s.c_no=1:s.c_no=0,o.push(s)}o.map((function(e){for(var t in e)e[t]={value:e[t],edit:!1}})),l.definedTableData=l.definedTableData.concat(o)}catch(e){console.log(e)}},r.readAsBinaryString(e.raw)},addTableData:function(){var e=[{c_element_code:"字段名",c_element_namech:"中文名",c_datatype:"text",c_element_unit:"单位",fieldLength:"32",filedPer:"0",orders:"0",c_isqc:"1",c_no:"0"}];e.map((function(e){for(var t in e)e[t]={value:e[t],edit:!1}})),this.definedTableData=this.definedTableData.concat(e),console.log(this.definedTableData)},deleteTableData:function(e){this.definedTableData.splice(e.$index,1)},definedTableEdit:function(e,t,a,l){var r=this;e[t.property]&&(e[t.property].edit=!0,setTimeout((function(){r.$refs[t.property].focus()}),20))},fileNameBlur:function(e){e.c_element_code.edit=!1,e.c_element_code.value.length>30?this.$message({type:"error",message:"输入长度不能大于30"}):/(^_([a-zA-Z0-9]_?)*$)|(^[a-zA-Z](_?[a-zA-Z0-9])*_?$)/.test(e.c_element_code.value)||this.$message({type:"error",message:"表名首位允许是字母以及下划线；首位之后可以是字母，数字以及下划线；下划线后不能接下划线"})},formatterQc:function(e){return 1==e.c_isqc?"是":"否"},formatterNo:function(e){return 1==e.c_no?"是":"否"},genUUID:function(){for(var e=[],t="0123456789abcdef",a=0;a<36;a++)e[a]=t.substr(Math.floor(16*Math.random()),1);e[14]="4",e[19]=t.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-";var l=e.join("");return l},tableDataChange:function(e){var t=this;this.tableDataMul=e,this.freuseFieldArr=[],this.definedTableDataMul.forEach((function(e){t.freuseFieldArr.push(e.c_element_code.value)})),this.tableDataMul.forEach((function(e){t.freuseFieldArr.push(e.c_element_code)})),this.registerForm.freuseField=this.freuseFieldArr.join(",")},definedTableDataChange:function(e){var t=this;this.freuseFieldArr=[],this.definedTableDataMul=e,this.tableDataMul.forEach((function(e){t.freuseFieldArr.push(e.c_element_code)})),this.definedTableDataMul.forEach((function(e){t.freuseFieldArr.push(e.c_element_code.value)})),this.registerForm.freuseField=this.freuseFieldArr.join(",")},makeSure:function(e){var t=this;if(e){var a=!0;this.$refs["registerForm"].validate(function(){var l=Object(n["a"])(regeneratorRuntime.mark((function l(r){var n;return regeneratorRuntime.wrap((function(l){while(1)switch(l.prev=l.next){case 0:if(!r){l.next=22;break}t.registerForm.applyId=t.genUUID(),t.registerForm.userId=localStorage.getItem("loginUserId"),n=0;case 4:if(!(n<t.definedTableData.length)){l.next=16;break}if(!(t.definedTableData[n].c_element_code.value.length>30)){l.next=9;break}return t.$message({type:"error",message:"输入长度不能大于30"}),a=!1,l.abrupt("break",16);case 9:if(/(^_([a-zA-Z0-9]_?)*$)|(^[a-zA-Z](_?[a-zA-Z0-9])*_?$)/.test(t.definedTableData[n].c_element_code.value)){l.next=13;break}return t.$message({type:"error",message:"【自定义字段】表名首位需是字母以及下划线；首位之后可以是字母，数字以及下划线；下划线后不能接下划线"}),a=!1,l.abrupt("break",16);case 13:n++,l.next=4;break;case 16:if(!a){l.next=22;break}return l.next=19,t.saveApplyInfo();case 19:return l.next=21,t.saveTableData();case 21:t.flage?(t.$message({type:"success",message:"操作成功，请等待存储管理系统管理员审核"}),t.$emit("operateData",e)):t.axios.get(interfaceObj.delNewData,{params:{applyId:t.registerForm.applyId,dDataId:"Z.9999.9999"}}).then((function(e){var t=e.data;console.log(t)})).catch((function(e){console.log(e)}));case 22:case"end":return l.stop()}}),l)})));return function(e){return l.apply(this,arguments)}}())}else this.$emit("operateData",e)},saveApplyInfo:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.axios({headers:{"Content-Type":"application/json"},method:"post",url:interfaceObj.addNewData,data:JSON.stringify(this.registerForm)}).then((function(e){var a=e.data;"0"==a.returnCode?t.flage=!0:(t.flage=!1,t.$message({type:"error",message:a.returnMessage}))})).catch((function(e){console.log(e)}));case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),saveTableData:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,a,l=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=JSON.parse(JSON.stringify(this.definedTableData)),t.map((function(e){for(var t in e)e[t]=e[t].value})),a=t.concat(this.tableData),a.forEach((function(e){e.applyId=l.registerForm.applyId,e.dDataId=l.registerForm.dDataId,e.accuracy=e.fieldLength+"."+e.filedPer})),e.next=6,this.axios({headers:{"Content-Type":"application/json"},method:"post",url:interfaceObj.addNewDataTableField,data:JSON.stringify(a)}).then((function(e){var t=e.data;0==t.returnCode?l.flage=!0:(l.flage=!1,l.$message({type:"error",message:t.returnMessage}))})).catch((function(e){console.log(e)}));case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),downFile:function(){var e=interfaceObj.demoWordUrl+"个人数据注册上传模板.xlsx";this.axios.get(interfaceObj.download+"?filepath="+e).then((function(t){testExport(interfaceObj.download+"?filepath="+e)})).catch((function(t){testExport(interfaceObj.download+"?filepath="+e)}))}}}),i=o,s=(a("40d5"),a("2877")),c=Object(s["a"])(i,l,r,!1,null,null,null);t["default"]=c.exports}}]);