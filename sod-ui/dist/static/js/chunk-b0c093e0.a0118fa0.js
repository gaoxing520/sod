(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b0c093e0"],{"5d77":function(e,a,t){"use strict";t.r(a);var s=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("section",{staticClass:"handleAccountDialog"},[t("el-form",{ref:"ruleForm",attrs:{rules:e.rules,model:e.msgFormDialog,"label-width":"100px"}},[t("el-row",[e.handleObj.pageName?e._e():t("el-col",{attrs:{span:7}},[t("el-form-item",{attrs:{label:"账户ID",prop:"databaseUpId"}},[t("el-input",{attrs:{size:"small",disabled:e.userDiasbled,placeholder:"账户ID"},model:{value:e.msgFormDialog.databaseUpId,callback:function(a){e.$set(e.msgFormDialog,"databaseUpId",a)},expression:"msgFormDialog.databaseUpId"}})],1)],1),e._v(" "),"业务用户审核"==e.handleObj.pageName?t("el-col",{attrs:{span:7}},[t("el-form-item",{attrs:{label:"用户名"}},[t("el-input",{attrs:{size:"small",disabled:e.userDiasbled,placeholder:"用户名"},model:{value:e.msgFormDialog.userName,callback:function(a){e.$set(e.msgFormDialog,"userName",a)},expression:"msgFormDialog.userName"}})],1)],1):e._e(),e._v(" "),t("el-col",{attrs:{span:7}},[t("el-form-item",{attrs:{label:"申请绑定IP",prop:"databaseUpIp"}},[t("el-input",{attrs:{size:"small",disabled:"",placeholder:e.palceholderIp},model:{value:e.msgFormDialog.databaseUpIp,callback:function(a){e.$set(e.msgFormDialog,"databaseUpIp",a)},expression:"msgFormDialog.databaseUpIp"}})],1)],1),e._v(" "),t("el-col",{attrs:{span:3}},[t("el-form-item",{staticClass:"unitFormItem"},[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.showEditIp}},[e._v("编辑")])],1)],1)],1),e._v(" "),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"数据库选择",prop:"applyDatabaseId"}},[t("el-transfer",{attrs:{data:e.dataBaseBox},model:{value:e.msgFormDialog.applyDatabaseId,callback:function(a){e.$set(e.msgFormDialog,"applyDatabaseId",a)},expression:"msgFormDialog.applyDatabaseId"}})],1)],1)],1),e._v(" "),e.handleObj.pageName?e._e():t("el-row",[t("el-col",{attrs:{span:7}},[t("el-form-item",{attrs:{label:"关联用户",prop:"userId"}},[t("el-select",{attrs:{size:"small",filterable:"",disabled:e.isDisabled,placeholder:"请选择"},on:{change:e.userChange},model:{value:e.msgFormDialog.userId,callback:function(a){e.$set(e.msgFormDialog,"userId",a)},expression:"msgFormDialog.userId"}},e._l(e.userBox,(function(e,a){return t("el-option",{key:a,attrs:{label:e.webUsername,value:e.userName,disabled:e.disabled}})})),1)],1)],1),e._v(" "),t("el-col",{attrs:{span:7}},[t("el-form-item",{attrs:{label:"机构"}},[t("el-input",{attrs:{size:"small",disabled:e.isDisabled,placeholder:"机构"},model:{value:e.msgFormDialog.deptName,callback:function(a){e.$set(e.msgFormDialog,"deptName",a)},expression:"msgFormDialog.deptName"}})],1)],1),e._v(" "),t("el-col",{attrs:{span:7}},[t("el-form-item",{attrs:{label:"联系方式"}},[t("el-input",{attrs:{size:"small",disabled:e.isDisabled,placeholder:"联系方式"},model:{value:e.msgFormDialog.tutorPhone,callback:function(a){e.$set(e.msgFormDialog,"tutorPhone",a)},expression:"msgFormDialog.tutorPhone"}})],1)],1),e._v(" "),t("el-col",{attrs:{span:3}})],1),e._v(" "),t("el-row",[t("el-col",{attrs:{span:21}},[t("el-form-item",{attrs:{label:"用途说明",prop:"databaseUpDesc"}},[t("el-input",{attrs:{size:"small",disabled:e.isDisabled,type:"textarea",placeholder:"用途说明"},model:{value:e.msgFormDialog.databaseUpDesc,callback:function(a){e.$set(e.msgFormDialog,"databaseUpDesc",a)},expression:"msgFormDialog.databaseUpDesc"}})],1)],1)],1),e._v(" "),t("el-row",[t("el-col",{attrs:{span:21}},[t("el-form-item",{staticClass:"fileInput",attrs:{label:"申请材料"}},[t("el-upload",{directives:[{name:"show",rawName:"v-show",value:e.isHideAdd,expression:"isHideAdd"}],staticClass:"upload-demo",attrs:{accept:".docx",drag:"",limit:1,"on-exceed":e.handleExceed,action:e.upLoadUrl,"before-remove":e.beforeRemove,"on-success":e.successUpload,name:"filename",multiple:""}},[t("i",{staticClass:"el-icon-upload"}),e._v(" "),t("div",{staticClass:"el-upload__text"},[e._v("\n              将文件拖到此处，或\n              "),t("em",[e._v("点击上传")]),e._v("（只能上传docx文件）\n            ")])]),e._v(" "),t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.isHideAdd,expression:"isHideAdd"}],staticClass:"reloaddemo",attrs:{size:"small",type:"success",icon:"el-icon-document"},on:{click:e.demoExport}},[e._v("模板下载")]),e._v(" "),t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.isHideAdd,expression:"isHideAdd"}],staticClass:"preViewBox",attrs:{size:"small",type:"success",icon:"el-icon-document"},on:{click:e.previewDocx}},[e._v("预览")]),e._v(" "),t("el-input",{directives:[{name:"show",rawName:"v-show",value:e.isHide,expression:"isHide"}],staticStyle:{width:"80%"},attrs:{size:"small",type:"text",disabled:""},model:{value:e.msgFormDialog.applyMaterial,callback:function(a){e.$set(e.msgFormDialog,"applyMaterial",a)},expression:"msgFormDialog.applyMaterial"}}),e._v(" "),t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.isHide,expression:"isHide"}],staticClass:"preViewBox2",attrs:{size:"small",type:"success",icon:"el-icon-document"},on:{click:e.previewDocx}},[e._v("预览")]),e._v(" "),t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.isHide,expression:"isHide"}],staticClass:"reloaddemo",attrs:{size:"small",type:"success",icon:"el-icon-document"},on:{click:e.detailExport}},[e._v("下载")])],1)],1),e._v(" "),t("el-col",{attrs:{span:3}})],1)],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.isHideAdd,expression:"isHideAdd"}],staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.trueDialog("ruleForm")}}},[e._v("确 定")]),e._v(" "),t("el-button",{on:{click:function(a){return e.cancelDialog("ruleForm")}}},[e._v("取 消")])],1),e._v(" "),e.handleObj.pageName?e._e():t("div",{directives:[{name:"show",rawName:"v-show",value:e.isHide,expression:"isHide"}],staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.trueDialog("ruleForm")}}},[e._v("通 过")]),e._v(" "),t("el-button",{on:{click:function(a){return e.cancelDialog("ruleForm")}}},[e._v("不 通 过")])],1),e._v(" "),t("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{width:"30%",title:"信息",visible:e.innerVisible,"append-to-body":""},on:{"update:visible":function(a){e.innerVisible=a}}},[t("div",{staticClass:"ipDialog"},[t("el-alert",{attrs:{title:"范例(指定IP:192.168.1.1;IP段：192.168.1.%)",type:"info",closable:!1}}),e._v(" "),t("el-form",{ref:"ipform",staticStyle:{"margin-top":"10px"},attrs:{model:e.ipArryForm,"label-width":"30px"}},e._l(e.ipArryForm.domains,(function(a,s){return t("el-form-item",{key:a.key,attrs:{label:s+1+""}},[t("el-input",{staticClass:"elInput",model:{value:a.value,callback:function(t){e.$set(a,"value",t)},expression:"domain.value"}}),e._v(" "),t("i",{staticClass:"el-icon-plus",on:{click:e.addDomain}}),e._v(" "),t("i",{staticClass:"el-icon-minus",on:{click:function(t){return t.preventDefault(),e.removeDomain(a)}}})],1)})),1),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.iptrueDialog("ipform")}}},[e._v("确 定")]),e._v(" "),t("el-button",{on:{click:function(a){return e.ipcancelDialog("ipform")}}},[e._v("取 消")])],1)],1)])],1)},r=[],i=(t("7514"),t("7f7f"),t("ac6a"),t("28a5"),t("96cf"),t("3b8d")),o=t("9553"),n=t("d0d2"),l=t("4b67"),d="http://10.40.79.18:8005",c={name:"handleAccountDialog",props:{handleObj:{type:Object}},data:function(){var e=this,a=function(a,t,s){t?Object(l["l"])(t)?s(new Error("数据库账号不能以数字开头")):void 0==e.handleObj.databaseUpId?Object(o["h"])({databaseUPId:t}).then((function(e){"YES"==e.ifExist?(console.log("重复"),s(new Error("数据库账号不能重复"))):(console.log("不重复"),s())})):s():s(new Error("请输入账户ID"))};return{ipArryForm:{domains:[{value:"",select:""}]},innerVisible:!1,downUrl:"",upLoadUrl:d+"/dm/databaseUser/api/databaseUser/upload",isDisabled:!1,userDiasbled:!1,isHideAdd:!0,isHide:!1,passwordType:"password",userBox:[],msgFormDialog:{databaseUpId:"USR_",databaseUpIp:"",databaseUpIpSegment:"1",applyDatabaseId:[],userId:"",databaseUpDesc:"",applyMaterial:"",pdfPath:""},palceholderIp:"指定IP样例:192.168.1.1",dataBaseBox:[],handleDocxObj:{},rules:{databaseUpId:[{required:!0,validator:a,trigger:"blur"}],databaseUpIp:[{required:!0,message:"请输入IP地址",trigger:"blur"}],applyDatabaseId:[{required:!0,message:"请选择数据库",trigger:"change"}],databaseUpDesc:[{required:!0,message:"请输入用途说明",trigger:"blur"}],userId:[{required:!0,message:"请选择关联用户",trigger:"change"}],applyMaterial:[{required:!0,message:"请选择申请材料",trigger:"change"}]}}},created:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getUserAll();case 2:this.getDBlist(),"业务用户审核"==this.handleObj.pageName?(this.userDiasbled=!0,this.msgFormDialog.userName=this.handleObj.userName,this.msgFormDialog.databaseUpIp=this.handleObj.bizIp,this.msgFormDialog.databaseUpDesc=this.handleObj.remark,this.msgFormDialog.applyMaterial=this.handleObj.applyPaper,this.msgFormDialog.applyDatabaseId=this.handleObj.dbIds.split(","),this.isHideAdd=!1,this.isHide=!0):this.initServerDetail(),console.log(this.handleObj);case 5:case"end":return e.stop()}}),e,this)})));function a(){return e.apply(this,arguments)}return a}(),methods:{demoExport:function(){var e=this;Object(o["e"])().then((function(a){e.downloadfileCommon(a)}))},detailExport:function(){var e=this;Object(o["f"])({filePath:this.msgFormDialog.applyMaterial}).then((function(a){e.downloadfileCommon(a)}))},previewDocx:function(){window.open(d+this.msgFormDialog.pdfPath)},removeDomain:function(e){var a=this.ipArryForm.domains.indexOf(e);0!==a&&this.ipArryForm.domains.splice(a,1)},addDomain:function(){this.ipArryForm.domains.push({value:"",key:Date.now()})},ipcancelDialog:function(e){this.$refs[e].resetFields(),this.innerVisible=!1},iptrueDialog:function(e){console.log(this.ipArryForm.domains);var a=[],t=this.ipArryForm.domains;t.forEach((function(e){a.push(e.value)}));for(var s=0;s<a.length;s++)if(!Object(l["f"])(a[s])&&!Object(l["g"])(a[s]))return void this.$message({type:"error",message:"请输入正确IP地址"});this.msgFormDialog.databaseUpIp=a.join(","),this.$refs[e].resetFields(),this.innerVisible=!1},showEditIp:function(){this.innerVisible=!0},showPwd:function(){"password"===this.passwordType?this.passwordType="":this.passwordType="password"},handleExceed:function(){this.$message.warning("当前限制选择1个文件")},beforeRemove:function(e,a){var t=this;return this.$confirm("确定移除 ".concat(e.name,"？"),{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.msgFormDialog.applyMaterial=""})).catch((function(){console.log("已取消删除")}))},successUpload:function(e,a,t){this.msgFormDialog.pdfPath=e.data.pdfPath,this.msgFormDialog.applyMaterial=e.data.filePath},userChange:function(e){var a={};a=this.userBox.find((function(a){return a.userName===e})),this.msgFormDialog.tutorPhone=a.phone,this.msgFormDialog.deptName=a.deptName},getDBlist:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["b"])().then((function(e){for(var t=e.data,s=[],r=0;r<t.length;r++){var i={};i.key=t[r].id,i.label=t[r].database_name,s.push(i)}a.dataBaseBox=s}));case 2:case"end":return e.stop()}}),e)})));function a(){return e.apply(this,arguments)}return a}(),getUserAll:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(n["h"])({userType:11}).then((function(e){a.userBox=e.data}));case 2:case"end":return e.stop()}}),e)})));function a(){return e.apply(this,arguments)}return a}(),initServerDetail:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.handleObj.id){e.next=6;break}return"0"==this.handleObj.examine_status?this.userDiasbled=!1:"2"==this.handleObj.examine_status?this.userDiasbled=!1:"1"==this.handleObj.examine_status&&(this.userDiasbled=!0),this.isHide=!0,this.isHideAdd=!1,e.next=6,Object(o["g"])({id:this.handleObj.id}).then((function(e){if(200==e.code){var t=e.data;t.applyDatabaseId=t.applyDatabaseId.split(","),console.log(t.applyDatabaseId),a.msgFormDialog=t,a.handleExportObj={},a.handleExportObj.filePath=a.msgFormDialog.applyMaterial}}));case 6:case"end":return e.stop()}}),e,this)})));function a(){return e.apply(this,arguments)}return a}(),trueDialog:function(e){var a=this;!this.isHideAdd||this.msgFormDialog.applyMaterial?this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;a.isHideAdd?a.trueAdd():a.auditMethods("")})):this.$message({message:"请上传申请材料",type:"error",offset:100})},trueAdd:function(){var e=this,a=this.msgFormDialog;a.applyDatabaseId=a.applyDatabaseId.join(","),console.log(a),Object(o["a"])(a).then((function(a){200==a.code?(e.$message({type:"success",message:"增加成功"}),e.$emit("handleDialogClose")):e.$message({type:"error",message:a.msg})}))},cancelDialog:function(e){var a=this;this.handleObj.id?this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;a.$prompt("请输入拒绝原因","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(e){var t=e.value;a.auditMethods(t)})).catch((function(){}))})):(this.$refs[e].resetFields(),this.$emit("handleDialogClose"))},auditMethods:function(e){var a=this;this.msgFormDialog.examineStatus=e?2:1,this.msgFormDialog.failureReason=e;var t=this.msgFormDialog;t.applyDatabaseId=t.applyDatabaseId.join(","),console.log(t),Object(o["i"])(t).then((function(e){200==e.code?(a.$message({type:"success",message:"操作成功"}),a.$emit("handleDialogClose")):a.$message({type:"error",message:e.msg})})),this.$emit("handleDialogClose")}}},u=c,m=(t("da16"),t("2877")),p=Object(m["a"])(u,s,r,!1,null,null,null);a["default"]=p.exports},7514:function(e,a,t){"use strict";var s=t("5ca1"),r=t("0a49")(5),i="find",o=!0;i in[]&&Array(1)[i]((function(){o=!1})),s(s.P+s.F*o,"Array",{find:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),t("9c6c")(i)},9553:function(e,a,t){"use strict";t.d(a,"a",(function(){return i})),t.d(a,"b",(function(){return o})),t.d(a,"c",(function(){return n})),t.d(a,"h",(function(){return l})),t.d(a,"d",(function(){return d})),t.d(a,"g",(function(){return c})),t.d(a,"i",(function(){return u})),t.d(a,"f",(function(){return m})),t.d(a,"e",(function(){return p}));var s=t("b775"),r="http://10.40.79.18:8005";function i(e){return Object(s["a"])({url:r+"/dm/databaseUser/add",method:"post",data:e})}function o(e){return Object(s["a"])({url:r+"/dm/databaseDefine/all",method:"get",params:e})}function n(e){return Object(s["a"])({url:r+"/dm/databaseUser/all",method:"get",params:e})}function l(e){return Object(s["a"])({url:r+"/dm/databaseUser/ifUPExist",async:!0,method:"get",params:e})}function d(e){return Object(s["a"])({url:r+"/dm/databaseUser/delete",async:!0,method:"delete",params:e})}function c(e){return Object(s["a"])({url:r+"/dm/databaseUser/getById",async:!0,method:"get",params:e})}function u(e){return Object(s["a"])({url:r+"/dm/databaseUser/update",method:"post",data:e})}function m(e){return Object(s["a"])({url:r+"/dm/databaseUser/exportData",method:"get",params:e,responseType:"arraybuffer"})}function p(){return Object(s["a"])({url:r+"/dm/fileUpDown/download",method:"get",params:{name:"databaseuser-application"},responseType:"arraybuffer"})}},d0d2:function(e,a,t){"use strict";t.d(a,"a",(function(){return i})),t.d(a,"g",(function(){return o})),t.d(a,"b",(function(){return n})),t.d(a,"i",(function(){return l})),t.d(a,"c",(function(){return d})),t.d(a,"f",(function(){return c})),t.d(a,"e",(function(){return u})),t.d(a,"d",(function(){return m})),t.d(a,"h",(function(){return p}));var s=t("b775"),r="http://10.40.79.18:8005";function i(e){return Object(s["a"])({url:r+"/dm/cloudDatabaseApply/list",method:"get",params:e})}function o(e){return Object(s["a"])({url:r+"/dm/cloudDatabaseApply/getDictDataByType/"+e,method:"get"})}function n(e){return Object(s["a"])({url:r+"/dm/cloudDatabaseApply/deleteById",method:"delete",params:e})}function l(e){return Object(s["a"])({url:r+"/dm/cloudDatabaseApply/save",method:"post",data:e})}function d(e){return Object(s["a"])({url:r+"/dm/cloudDatabaseApply/edit",method:"put",data:e})}function c(e){return Object(s["a"])({url:r+"/dm/cloudDatabaseApply/getById",method:"get",params:e})}function u(e){return Object(s["a"])({url:r+"/dm/cloudDatabaseApply/download",method:"get",params:e,responseType:"arraybuffer"})}function m(){return Object(s["a"])({url:r+"/dm/databaseDefine/export",method:"get",params:{name:"clouddatabase-application"},responseType:"arraybuffer"})}function p(e){return Object(s["a"])({url:r+"/system/user/getUserByType",method:"get",params:e})}},da16:function(e,a,t){"use strict";var s=t("ea1c"),r=t.n(s);r.a},ea1c:function(e,a,t){}}]);